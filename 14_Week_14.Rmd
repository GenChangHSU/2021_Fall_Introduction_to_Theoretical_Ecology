```{r setup, include = FALSE}
knitr::opts_chunk$set(message = F, 
                      error = F, 
                      warning = F)

```

# Week 14 {-} 
<div style = "font-size: 28pt"> **_Disease dynamics and SIR models_**</div>

## Lecture in a nutshell {-}

* **Topic:**
    1. 
    2. 
    3. 
    
<div style="height:1px ;"><br></div>

* **Topic:**
    1. 
    2. 
    3.

<div style="height:1px ;"><br></div>    
<br>


## Lab demonstration {-}

In today's lab, we are going to simulate the SIR model with demography and visualize the disease dynamics:

<div style="margin-left: 30%;">$\begin{align}\frac {dS}{dt} = \lambda-\beta SI-dS\end{align}\\$</div>
<div style="margin-left: 30%;">$\begin{align}\frac {dI}{dt} = \beta SI-(d+\delta)I-\gamma I\end{align}\\$</div>
<div style="margin-left: 30%; margin-bottom: 15px;">$\begin{align}\frac {dR}{dt} = \gamma I-dR\end{align}$</div>

```{r, fig.width = 5, fig.height = 3.5, out.width = "70%", fig.align = "center"}
library(tidyverse)
library(deSolve)

SIR_model <- function(times, state, parms) {
  with(as.list(c(state, parms)), {
    dS_dt = lambda - beta*S*I - d*S
    dI_dt = beta*S*I - (d+delta)*I - gamma*I 
    dR_dt = gamma*I - d*R
    return(list(c(dS_dt, dI_dt, dR_dt)))
  })
}

times <- seq(0, 1000, by = 1)
state <- c(S = 100, I = 2, R = 0)
parms <- c(lambda = 0.25, beta = 0.01, d = 0.01, delta = 0.01, gamma = 0.02)

SIR_out <- ode(func = SIR_model, times = times, y = state, parms = parms)

### Visualize the population dynamics
SIR_out %>%
  as.data.frame() %>%
  pivot_longer(cols = -time, names_to = "state", values_to = "N") %>%
  ggplot(aes(x = time, y = N, color = fct_reorder(state, N, last, .desc = T))) + 
  geom_line(size = 1.5) +
  theme_classic(base_size = 14) +
  labs(x = "Time", y = "N") +
  scale_x_continuous(limits = c(0, 1010), expand = c(0, 0)) +
  scale_y_continuous(limits = c(0, 110), expand = c(0, 0)) +
  scale_color_brewer(name = NULL, palette = "Set1") 

```

<br>

## Additional readings {-}

No additional readings this week.

<br>

## Assignments {-}

No assignments this week.


