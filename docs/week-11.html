<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Week 11 | Introduction to Theoretical Ecology</title>
  <meta name="description" content="This is the course website for Introduction to Theoretical Ecology 2021 Fall at National Taiwan University." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Week 11 | Introduction to Theoretical Ecology" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://genchanghsu.github.io/2021_Fall_Introduction_to_Theoretical_Ecology/" />
  <meta property="og:image" content="https://genchanghsu.github.io/2021_Fall_Introduction_to_Theoretical_Ecology//bifurcation.gif" />
  <meta property="og:description" content="This is the course website for Introduction to Theoretical Ecology 2021 Fall at National Taiwan University." />
  <meta name="github-repo" content="GenChangHSU/2021_Fall_Introduction_to_Theoretical_Ecology" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Week 11 | Introduction to Theoretical Ecology" />
  
  <meta name="twitter:description" content="This is the course website for Introduction to Theoretical Ecology 2021 Fall at National Taiwan University." />
  <meta name="twitter:image" content="https://genchanghsu.github.io/2021_Fall_Introduction_to_Theoretical_Ecology//bifurcation.gif" />

<meta name="author" content="Instructor: Po-Ju Ke ~~~~~ Teaching Assistant: Gen-Chang Hsu" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="week-10.html"/>
<link rel="next" href="week-12.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introduction to Theoretical Ecology</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Course Information</a></li>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html"><i class="fa fa-check"></i>Syllabus</a></li>
<li class="chapter" data-level="" data-path="week-1.html"><a href="week-1.html"><i class="fa fa-check"></i>Week 1</a>
<ul>
<li class="chapter" data-level="" data-path="week-1.html"><a href="week-1.html#lecture-in-a-nutshell"><i class="fa fa-check"></i>Lecture in a nutshell</a></li>
<li class="chapter" data-level="" data-path="week-1.html"><a href="week-1.html#lab-demonstration"><i class="fa fa-check"></i>Lab demonstration</a></li>
<li class="chapter" data-level="" data-path="week-1.html"><a href="week-1.html#additional-readings"><i class="fa fa-check"></i>Additional readings</a></li>
<li class="chapter" data-level="" data-path="week-1.html"><a href="week-1.html#assignments"><i class="fa fa-check"></i>Assignments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-2.html"><a href="week-2.html"><i class="fa fa-check"></i>Week 2</a>
<ul>
<li class="chapter" data-level="" data-path="week-2.html"><a href="week-2.html#lecture-in-a-nutshell-1"><i class="fa fa-check"></i>Lecture in a nutshell</a></li>
<li class="chapter" data-level="" data-path="week-2.html"><a href="week-2.html#lab-demonstration-1"><i class="fa fa-check"></i>Lab demonstration</a></li>
<li class="chapter" data-level="" data-path="week-2.html"><a href="week-2.html#additional-readings-1"><i class="fa fa-check"></i>Additional readings</a></li>
<li class="chapter" data-level="" data-path="week-2.html"><a href="week-2.html#assignments-1"><i class="fa fa-check"></i>Assignments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-3.html"><a href="week-3.html"><i class="fa fa-check"></i>Week 3</a>
<ul>
<li class="chapter" data-level="" data-path="week-3.html"><a href="week-3.html#lecture-in-a-nutshell-2"><i class="fa fa-check"></i>Lecture in a nutshell</a></li>
<li class="chapter" data-level="" data-path="week-3.html"><a href="week-3.html#lab-demonstration-2"><i class="fa fa-check"></i>Lab demonstration</a></li>
<li class="chapter" data-level="" data-path="week-3.html"><a href="week-3.html#additional-readings-2"><i class="fa fa-check"></i>Additional readings</a></li>
<li class="chapter" data-level="" data-path="week-3.html"><a href="week-3.html#assignments-2"><i class="fa fa-check"></i>Assignments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-4.html"><a href="week-4.html"><i class="fa fa-check"></i>Week 4</a>
<ul>
<li class="chapter" data-level="" data-path="week-4.html"><a href="week-4.html#lecture-in-a-nutshell-3"><i class="fa fa-check"></i>Lecture in a nutshell</a></li>
<li class="chapter" data-level="" data-path="week-4.html"><a href="week-4.html#lab-demonstration-3"><i class="fa fa-check"></i>Lab demonstration</a></li>
<li class="chapter" data-level="" data-path="week-4.html"><a href="week-4.html#additional-readings-3"><i class="fa fa-check"></i>Additional readings</a></li>
<li class="chapter" data-level="" data-path="week-4.html"><a href="week-4.html#assignments-3"><i class="fa fa-check"></i>Assignments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-5.html"><a href="week-5.html"><i class="fa fa-check"></i>Week 5</a>
<ul>
<li class="chapter" data-level="" data-path="week-5.html"><a href="week-5.html#lecture-in-a-nutshell-4"><i class="fa fa-check"></i>Lecture in a nutshell</a></li>
<li class="chapter" data-level="" data-path="week-5.html"><a href="week-5.html#lab-demonstration-4"><i class="fa fa-check"></i>Lab demonstration</a></li>
<li class="chapter" data-level="" data-path="week-5.html"><a href="week-5.html#additional-readings-4"><i class="fa fa-check"></i>Additional readings</a></li>
<li class="chapter" data-level="" data-path="week-5.html"><a href="week-5.html#assignments-4"><i class="fa fa-check"></i>Assignments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-6.html"><a href="week-6.html"><i class="fa fa-check"></i>Week 6</a>
<ul>
<li class="chapter" data-level="" data-path="week-6.html"><a href="week-6.html#lecture-in-a-nutshell-5"><i class="fa fa-check"></i>Lecture in a nutshell</a></li>
<li class="chapter" data-level="" data-path="week-6.html"><a href="week-6.html#lab-demonstration-5"><i class="fa fa-check"></i>Lab demonstration</a></li>
<li class="chapter" data-level="" data-path="week-6.html"><a href="week-6.html#additional-readings-5"><i class="fa fa-check"></i>Additional readings</a></li>
<li class="chapter" data-level="" data-path="week-6.html"><a href="week-6.html#assignments-5"><i class="fa fa-check"></i>Assignments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-7.html"><a href="week-7.html"><i class="fa fa-check"></i>Week 7</a>
<ul>
<li class="chapter" data-level="" data-path="week-7.html"><a href="week-7.html#lecture-in-a-nutshell-6"><i class="fa fa-check"></i>Lecture in a nutshell</a></li>
<li class="chapter" data-level="" data-path="week-7.html"><a href="week-7.html#lab-demonstration-6"><i class="fa fa-check"></i>Lab demonstration</a></li>
<li class="chapter" data-level="" data-path="week-7.html"><a href="week-7.html#additional-readings-6"><i class="fa fa-check"></i>Additional readings</a></li>
<li class="chapter" data-level="" data-path="week-7.html"><a href="week-7.html#assignments-6"><i class="fa fa-check"></i>Assignments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-8.html"><a href="week-8.html"><i class="fa fa-check"></i>Week 8</a>
<ul>
<li class="chapter" data-level="" data-path="week-8.html"><a href="week-8.html#lecture-in-a-nutshell-7"><i class="fa fa-check"></i>Lecture in a nutshell</a></li>
<li class="chapter" data-level="" data-path="week-8.html"><a href="week-8.html#lab-demonstration-7"><i class="fa fa-check"></i>Lab demonstration</a></li>
<li class="chapter" data-level="" data-path="week-8.html"><a href="week-8.html#additional-readings-7"><i class="fa fa-check"></i>Additional readings</a></li>
<li class="chapter" data-level="" data-path="week-8.html"><a href="week-8.html#assignments-7"><i class="fa fa-check"></i>Assignments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-9.html"><a href="week-9.html"><i class="fa fa-check"></i>Week 9</a></li>
<li class="chapter" data-level="" data-path="week-10.html"><a href="week-10.html"><i class="fa fa-check"></i>Week 10</a>
<ul>
<li class="chapter" data-level="" data-path="week-10.html"><a href="week-10.html#lecture-in-a-nutshell-8"><i class="fa fa-check"></i>Lecture in a nutshell</a></li>
<li class="chapter" data-level="" data-path="week-10.html"><a href="week-10.html#lab-demonstration-8"><i class="fa fa-check"></i>Lab demonstration</a></li>
<li class="chapter" data-level="" data-path="week-10.html"><a href="week-10.html#additional-readings-8"><i class="fa fa-check"></i>Additional readings</a></li>
<li class="chapter" data-level="" data-path="week-10.html"><a href="week-10.html#assignments-8"><i class="fa fa-check"></i>Assignments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-11.html"><a href="week-11.html"><i class="fa fa-check"></i>Week 11</a>
<ul>
<li class="chapter" data-level="" data-path="week-11.html"><a href="week-11.html#lecture-in-a-nutshell-9"><i class="fa fa-check"></i>Lecture in a nutshell</a></li>
<li class="chapter" data-level="" data-path="week-11.html"><a href="week-11.html#lab-demonstration-9"><i class="fa fa-check"></i>Lab demonstration</a>
<ul>
<li class="chapter" data-level="" data-path="week-11.html"><a href="week-11.html#special-topic-time-scale-separation"><i class="fa fa-check"></i>Special topic: time-scale separation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-11.html"><a href="week-11.html#additional-readings-9"><i class="fa fa-check"></i>Additional readings</a></li>
<li class="chapter" data-level="" data-path="week-11.html"><a href="week-11.html#assignments-9"><i class="fa fa-check"></i>Assignments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-12.html"><a href="week-12.html"><i class="fa fa-check"></i>Week 12</a>
<ul>
<li class="chapter" data-level="" data-path="week-12.html"><a href="week-12.html#lecture-in-a-nutshell-10"><i class="fa fa-check"></i>Lecture in a nutshell</a></li>
<li class="chapter" data-level="" data-path="week-12.html"><a href="week-12.html#lab-demonstration-10"><i class="fa fa-check"></i>Lab demonstration</a>
<ul>
<li class="chapter" data-level="" data-path="week-12.html"><a href="week-12.html#part-1---r-rule"><i class="fa fa-check"></i>Part 1 - R* rule</a></li>
<li class="chapter" data-level="" data-path="week-12.html"><a href="week-12.html#part-2---tilmans-resource-ratio-hypothesis"><i class="fa fa-check"></i>Part 2 - Tilman’s resource ratio hypothesis</a></li>
<li class="chapter" data-level="" data-path="week-12.html"><a href="week-12.html#part-3---relative-nonlinearity"><i class="fa fa-check"></i>Part 3 - Relative nonlinearity</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-12.html"><a href="week-12.html#additional-readings-10"><i class="fa fa-check"></i>Additional readings</a></li>
<li class="chapter" data-level="" data-path="week-12.html"><a href="week-12.html#assignments-10"><i class="fa fa-check"></i>Assignments</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Site built with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Theoretical Ecology</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="week-11" class="section level1 unnumbered">
<h1>Week 11</h1>
<div style="font-size: 28pt">
<strong><em>Lotka-Volterra model of predator-prey interactions (2)</em></strong>
</div>
<div id="lecture-in-a-nutshell-9" class="section level2 unnumbered">
<h2>Lecture in a nutshell</h2>
<p>(Continued from Week 10)</p>
<ul>
<li><strong>Model 2. Logistic growth of prey + Type I functional response</strong>
<ol style="list-style-type: decimal">
<li>Model equations:
<div style="margin-left: 30%;">
<span class="math inline">\(\begin{align}\frac {dN}{dt} = rN(1-\frac{N}{K})-aNP\end{align}\\\)</span>
</div>
<div style="margin-left: 30%; margin-bottom: 5px;">
<span class="math inline">\(\begin{align}\frac {dP}{dt} = eaNP-dP\end{align}\)</span>
</div></li>
<li>The equilibrium points <span class="math inline">\((N^{*}, P^{*})\)</span>:
<ul>
<li><span class="math inline">\(E_{0} = (0, 0)\)</span></li>
<li><span class="math inline">\(E_{N} = (K, 0)\)</span></li>
<li><span class="math inline">\(E_{NP} = (\frac{d}{ea}, \frac{r}{a}(1-\frac{d}{eak}))\)</span></li>
</ul></li>
<li>Local stability analysis:
<ol style="list-style-type: decimal">
<li><span class="math inline">\(E_{0}\)</span>
<ul>
<li><span class="math inline">\(J_{E_{0}} = \begin{vmatrix}r &amp; 0 \\ 0 &amp; -d\end{vmatrix}\)</span></li>
<li><span class="math inline">\(\lambda&#39;s = r\)</span> and <span class="math inline">\(-d\)</span> (one positive and one negative)</li>
<li>Unstable</li>
</ul></li>
<li><span class="math inline">\(E_{N}\)</span>
<ul>
<li><span class="math inline">\(J_{E_{N}} = \begin{vmatrix}-r &amp; -aK \\ 0 &amp; eaK-d\end{vmatrix}\)</span></li>
<li><span class="math inline">\(\lambda&#39;s = -r\)</span> and <span class="math inline">\(eaK-d\)</span></li>
<li>Stable if <span class="math inline">\(eaK &lt; d~(K &lt; \frac{d}{ea})\)</span><br />
</li>
</ul></li>
<li><span class="math inline">\(E_{NP}\)</span>
<ul>
<li><span class="math inline">\(J_{E_{NP}} = \begin{vmatrix}-\frac{rd}{eaK} &amp; -\frac{d}{e} \\ eaP^{*} &amp; 0\end{vmatrix}\)</span></li>
<li>Characteristic equation: <span class="math inline">\(\lambda^{2} - (\frac{rd}{eaK})\lambda + adP^{*} = 0\)</span></li>
<li><span class="math inline">\(\lambda_{1} + \lambda_{2} = -\frac{rd}{eaK} &lt; 0~\&amp;~\lambda_{1}\lambda_{2} = adP^{*} &gt; 0\)</span></li>
<li>Stable if <span class="math inline">\(P^{*} &gt; 0\)</span> (feasibility) and <span class="math inline">\(K &gt; \frac{d}{ea}\)</span></li>
</ul></li>
</ol></li>
</ol></li>
</ul>
<div style="height:1px ;">
<br>
</div>
<ul>
<li><strong>Model 3. Exponential growth of prey + Type II functional response</strong>
<ol style="list-style-type: decimal">
<li>Model equations:
<div style="margin-left: 30%;">
<span class="math inline">\(\begin{align}\frac {dN}{dt} = rN-(\frac{aN}{1+ahN})P\end{align}\\\)</span>
</div>
<div style="margin-left: 30%; margin-bottom: 5px;">
<span class="math inline">\(\begin{align}\frac {dP}{dt} = e(\frac{aN}{1+ahN})P-dP\end{align}\)</span>
</div></li>
<li>Internal equilibrium is unstable (oscillations with increasing amplitude)</li>
</ol></li>
</ul>
<div style="height:1px ;">
<br>
</div>
<ul>
<li><strong>Model 4. Logistic growth of prey + Type II functional response</strong>
<ol style="list-style-type: decimal">
<li>Model equations:
<div style="margin-left: 30%;">
<span class="math inline">\(\begin{align}\frac {dN}{dt} = rN(1-\frac{N}{K})-(\frac{aN}{1+ahN})P\end{align}\\\)</span>
</div>
<div style="margin-left: 30%; margin-bottom: 5px;">
<span class="math inline">\(\begin{align}\frac {dP}{dt} = e(\frac{aN}{1+ahN})P-dP\end{align}\)</span>
</div></li>
<li>The equilibrium points <span class="math inline">\((N^{*}, P^{*})\)</span>:
<ul>
<li><span class="math inline">\(E_{0} = (0, 0)\)</span></li>
<li><span class="math inline">\(E_{N} = (K, 0)\)</span></li>
<li><span class="math inline">\(E_{NP} = (\frac{d}{a(e-dh)}, \frac{r}{a}(1-\frac{d}{a(e-dh)k})(1+ah\frac{d}{a(e-dh)}))\)</span></li>
</ul></li>
<li>Local stability analysis:
<ol style="list-style-type: decimal">
<li><span class="math inline">\(E_{0}\)</span>
<ul>
<li><span class="math inline">\(J_{E_{0}} = \begin{vmatrix}r &amp; 0 \\ 0 &amp; -d\end{vmatrix}\)</span></li>
<li><span class="math inline">\(\lambda&#39;s = r\)</span> and <span class="math inline">\(-d\)</span></li>
<li>Unstable</li>
</ul></li>
<li><span class="math inline">\(E_{N}\)</span>
<ul>
<li><span class="math inline">\(J_{E_{N}} = \begin{vmatrix}-r &amp; \frac{-aK}{1+ahK} \\ 0 &amp; \frac{eaK}{1+ahK}-d\end{vmatrix}\)</span></li>
<li><span class="math inline">\(\lambda&#39;s = -r\)</span> and <span class="math inline">\(\frac{eaK}{1+ahK}-d\)</span></li>
<li>Stable if <span class="math inline">\((K &lt; \frac{d}{a(e-dh)})\)</span><br />
</li>
</ul></li>
<li><span class="math inline">\(E_{NP}\)</span>
<ul>
<li><span class="math inline">\(J_{E_{NP}} = \begin{vmatrix}N^{*}(\frac{-r}{K}+\frac{a^{2}hP^{*}}{(1+ahN^{*})^{2}}) &amp; -\frac{aN^{*}}{1+ahN^{*}} \\ \frac{eaP^{*}}{(1+ahN^{*})^{2}} &amp; 0\end{vmatrix}\)</span></li>
<li>Characteristic equation: <span class="math inline">\(\lambda^{2} - N^{*}(\frac{-r}{K}+\frac{a^{2}hP^{*}}{(1+ahN^{*})^{2}})\lambda + \frac{ea^{2}N^{*}P^{*}}{(1+ahN^{*})^{3}} = 0\)</span></li>
<li>If feasible (<span class="math inline">\(N^{*}, P^{*} &gt; 0\)</span>), <span class="math inline">\(E_{NP}\)</span> is stable if <span class="math inline">\(\frac{-r}{K}+\frac{a^{2}hP^{*}}{(1+ahN^{*})^{2}} &lt; 0\)</span> (or <span class="math inline">\(N^{*} &gt; \frac{-1+ahk}{2ah}\)</span>)</li>
<li>Paradox of enrichment: increasing the carrying capacity K of prey will destabilize the system</li>
<li>Poincaré–Bendixson theorem: the trajectory must exhibit sustained periodic motion in a bounded 2D state-space if there is no equilibrium within.</li>
</ul></li>
</ol></li>
</ol></li>
</ul>
<p><br></p>
</div>
<div id="lab-demonstration-9" class="section level2 unnumbered">
<h2>Lab demonstration</h2>
<p>Similar to what we’ve done in the previous class, in this lab we are going to analyze the Rosenzweig–MacArthur predator–prey model:</p>
<div style="margin-left: 30%;">
<span class="math inline">\(\begin{align}\frac {dN}{dt} = rN(1-\frac{N}{K})-a\frac{N}{1+ahN}P\end{align}\\\)</span>
</div>
<div style="margin-left: 30%; margin-bottom: 10px;">
<span class="math inline">\(\begin{align}\frac {dP}{dt} = ea\frac{N}{1+ahN}P-dP\end{align}\)</span>
</div>
<p>Please simulate the model using the parameter set (<em>N</em> = 5, <em>P</em> = 2, <em>r</em> = 1.0, <em>K</em> = 5.0, <em>a</em> = 1.3, <em>h</em> = 0.9, <em>e</em> = 0.6, <em>d</em> = 0.5) and plot the population trajectories of predator and prey as well as show their population dynamics in the state-space diagram.</p>
<p>What will happen if you add a perturbation to the system (i.e., change the initial conditions)? Try out different values of <em>N</em> and <em>P</em> and visualize the differences in the state-space diagram. Also compare the results of the Rosenzweig–MacArthur model and the original Lotka-Volterra model. What do you find regarding the final equilibrium cycles?</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="week-11.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb37-2"><a href="week-11.html#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(deSolve)</span>
<span id="cb37-3"><a href="week-11.html#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="week-11.html#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="do">### Model specification</span></span>
<span id="cb37-5"><a href="week-11.html#cb37-5" aria-hidden="true" tabindex="-1"></a>RM_predation_model <span class="ot">&lt;-</span> <span class="cf">function</span>(times, state, parms) {</span>
<span id="cb37-6"><a href="week-11.html#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">as.list</span>(<span class="fu">c</span>(state, parms)), {</span>
<span id="cb37-7"><a href="week-11.html#cb37-7" aria-hidden="true" tabindex="-1"></a>    dN_dt <span class="ot">=</span> r<span class="sc">*</span>N<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>(N<span class="sc">/</span>K))<span class="sc">-</span>(a<span class="sc">*</span>N<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>a<span class="sc">*</span>h<span class="sc">*</span>N))<span class="sc">*</span>P</span>
<span id="cb37-8"><a href="week-11.html#cb37-8" aria-hidden="true" tabindex="-1"></a>    dP_dt <span class="ot">=</span> e<span class="sc">*</span>(a<span class="sc">*</span>N<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>a<span class="sc">*</span>h<span class="sc">*</span>N))<span class="sc">*</span>P<span class="sc">-</span>d<span class="sc">*</span>P</span>
<span id="cb37-9"><a href="week-11.html#cb37-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="fu">c</span>(dN_dt, dP_dt)))  </span>
<span id="cb37-10"><a href="week-11.html#cb37-10" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb37-11"><a href="week-11.html#cb37-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-12"><a href="week-11.html#cb37-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-13"><a href="week-11.html#cb37-13" aria-hidden="true" tabindex="-1"></a><span class="do">### Model parameters</span></span>
<span id="cb37-14"><a href="week-11.html#cb37-14" aria-hidden="true" tabindex="-1"></a>times <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">200</span>, <span class="at">by =</span> <span class="fl">0.01</span>)  </span>
<span id="cb37-15"><a href="week-11.html#cb37-15" aria-hidden="true" tabindex="-1"></a>state <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">N =</span> <span class="dv">5</span>, <span class="at">P =</span> <span class="dv">2</span>)  </span>
<span id="cb37-16"><a href="week-11.html#cb37-16" aria-hidden="true" tabindex="-1"></a>parms <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">r =</span> <span class="fl">1.0</span>, <span class="at">K =</span> <span class="fl">5.0</span>, <span class="at">a =</span> <span class="fl">1.3</span>, <span class="at">h =</span> <span class="fl">0.9</span>, <span class="at">e =</span> <span class="fl">0.6</span>, <span class="at">d =</span> <span class="fl">0.5</span>) </span>
<span id="cb37-17"><a href="week-11.html#cb37-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-18"><a href="week-11.html#cb37-18" aria-hidden="true" tabindex="-1"></a><span class="do">### Model application</span></span>
<span id="cb37-19"><a href="week-11.html#cb37-19" aria-hidden="true" tabindex="-1"></a>pop_size <span class="ot">&lt;-</span> <span class="fu">ode</span>(<span class="at">func =</span> RM_predation_model, <span class="at">times =</span> times, <span class="at">y =</span> state, <span class="at">parms =</span> parms)</span>
<span id="cb37-20"><a href="week-11.html#cb37-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-21"><a href="week-11.html#cb37-21" aria-hidden="true" tabindex="-1"></a><span class="do">### Visualize the population dynamics</span></span>
<span id="cb37-22"><a href="week-11.html#cb37-22" aria-hidden="true" tabindex="-1"></a><span class="co"># (1) population trajectories</span></span>
<span id="cb37-23"><a href="week-11.html#cb37-23" aria-hidden="true" tabindex="-1"></a>pop_size <span class="sc">%&gt;%</span></span>
<span id="cb37-24"><a href="week-11.html#cb37-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb37-25"><a href="week-11.html#cb37-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>time, <span class="at">names_to =</span> <span class="st">&quot;species&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;N&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-26"><a href="week-11.html#cb37-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> N, <span class="at">color =</span> species)) <span class="sc">+</span> </span>
<span id="cb37-27"><a href="week-11.html#cb37-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb37-28"><a href="week-11.html#cb37-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb37-29"><a href="week-11.html#cb37-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Time&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Population size&quot;</span>) <span class="sc">+</span></span>
<span id="cb37-30"><a href="week-11.html#cb37-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">200.5</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb37-31"><a href="week-11.html#cb37-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(pop_size[, <span class="sc">-</span><span class="dv">1</span>])<span class="sc">*</span><span class="fl">1.2</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb37-32"><a href="week-11.html#cb37-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">name =</span> <span class="cn">NULL</span>, <span class="at">palette =</span> <span class="st">&quot;Set1&quot;</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Prey&quot;</span>, <span class="st">&quot;Predator&quot;</span>), <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="11_Week_11_files/figure-html/unnamed-chunk-1-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="week-11.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (2) state-space diagram</span></span>
<span id="cb38-2"><a href="week-11.html#cb38-2" aria-hidden="true" tabindex="-1"></a>pop_size <span class="sc">%&gt;%</span></span>
<span id="cb38-3"><a href="week-11.html#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb38-4"><a href="week-11.html#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> N, <span class="at">y =</span> P)) <span class="sc">+</span> </span>
<span id="cb38-5"><a href="week-11.html#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>() <span class="sc">+</span> </span>
<span id="cb38-6"><a href="week-11.html#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">with</span>(<span class="fu">as.list</span>(parms), d<span class="sc">/</span>(e<span class="sc">*</span>a<span class="sc">-</span>a<span class="sc">*</span>d<span class="sc">*</span>h)), <span class="at">color =</span> <span class="st">&quot;#E41A1C&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb38-7"><a href="week-11.html#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="fl">0.01</span>)), <span class="fu">aes</span>(<span class="at">x =</span> x), <span class="at">fun =</span> <span class="cf">function</span>(n){<span class="fu">with</span>(<span class="fu">as.list</span>(parms), r<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>a<span class="sc">*</span>h<span class="sc">*</span>n)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>n<span class="sc">/</span>K)<span class="sc">/</span>a)}, <span class="at">inherit.aes =</span> F, <span class="at">color =</span> <span class="st">&quot;#377EB8&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb38-8"><a href="week-11.html#cb38-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">tail</span>(N, <span class="dv">1</span>), <span class="at">y =</span> <span class="fu">tail</span>(P, <span class="dv">1</span>)), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb38-9"><a href="week-11.html#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb38-10"><a href="week-11.html#cb38-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;#E41A1C&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb38-11"><a href="week-11.html#cb38-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;#377EB8&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb38-12"><a href="week-11.html#cb38-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Prey&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Predator&quot;</span>) <span class="sc">+</span> </span>
<span id="cb38-13"><a href="week-11.html#cb38-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(pop_size[, <span class="st">&quot;N&quot;</span>]<span class="sc">*</span><span class="fl">1.05</span>)), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span> </span>
<span id="cb38-14"><a href="week-11.html#cb38-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(pop_size[, <span class="st">&quot;P&quot;</span>]<span class="sc">*</span><span class="fl">1.05</span>)), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) </span></code></pre></div>
<p><img src="11_Week_11_files/figure-html/unnamed-chunk-1-2.png" width="70%" style="display: block; margin: auto;" />
<br></p>
<style>
iframe {border: 0;}
</style>
<!-- Here is a shiny app for the Rosenzweig–MacArthur predator–prey model. Feel free to play around with different parameter inputs and see how the system dynamics change accordingly. -->
<iframe src="https://genchanghsu0115.shinyapps.io/RM_predation_mod_shinyapp/?showcase=0" width="800px" height="700px" data-external="1">
</iframe>
<div id="special-topic-time-scale-separation" class="section level3 unnumbered">
<h3>Special topic: time-scale separation</h3>
<p>Time-scale separation is a useful technique to reduce the dimension of the model system, where some state variables are assumed to operate at a much shorter time scale (i.e., fast variables) compared with the others (i.e., slow variables). The fast variables will adjust rapidly to their new equilibria in response to a slight change in the slow variables, such that the slow variables can be viewed as “constants” from the perspective of fast variables.</p>
<p>Here, we are going to use the Lotka-Volterra model with logistic prey growth to demonstrate time-scale separation:</p>
<div style="margin-left: 30%;">
<span class="math inline">\(\begin{align}\frac {dN}{dt} = rN(1-\frac{N}{K})-aNP\end{align}\\\)</span>
</div>
<div style="margin-left: 30%; margin-bottom: 10px;">
<span class="math inline">\(\begin{align}\frac {dP}{dt} = eaNP-dP\end{align}\)</span>
</div>
<p>We will treat prey as a fast variable and predator as a slow variable. First, we find the quasi-equilibrium <span class="math inline">\(N^{\wedge}\)</span> of prey by setting the prey equation to zero:</p>
<div style="margin-left: 30%;">
<span class="math inline">\(\begin{align}N^{\wedge} = K(1-\frac{aP}{r}) \end{align}\)</span>
</div>
<p>And then we plug <span class="math inline">\(N^{\wedge}\)</span> into predator equation:</p>
<div style="margin-left: 30%; margin-bottom: 10px;">
<span class="math inline">\(\begin{align}\frac {dP}{dt} = (eaK-d)P(1-\frac{eaK(\frac{a}{r})}{eaK-d}P)\end{align}\)</span>
</div>
<p>What do you see in the above equation? It is actually a logistic growth model! So under time-scale separation, predator will exhibit logistic population growth. We will show this shortly in the code below.</p>
<p>One simple way to achieve time-scale separation in this model is to increase the prey growth rate so that prey will grow much faster than predator, mimicking the shorter generation time of prey relative to that of predator.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="week-11.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb39-2"><a href="week-11.html#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(deSolve)</span>
<span id="cb39-3"><a href="week-11.html#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="week-11.html#cb39-4" aria-hidden="true" tabindex="-1"></a>Prey_logistic_model <span class="ot">&lt;-</span> <span class="cf">function</span>(times, state, parms) {</span>
<span id="cb39-5"><a href="week-11.html#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">as.list</span>(<span class="fu">c</span>(state, parms)), {</span>
<span id="cb39-6"><a href="week-11.html#cb39-6" aria-hidden="true" tabindex="-1"></a>    dN_dt <span class="ot">=</span> r<span class="sc">*</span>N<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>(N<span class="sc">/</span>K))<span class="sc">-</span>a<span class="sc">*</span>N<span class="sc">*</span>P</span>
<span id="cb39-7"><a href="week-11.html#cb39-7" aria-hidden="true" tabindex="-1"></a>    dP_dt <span class="ot">=</span> e<span class="sc">*</span>a<span class="sc">*</span>N<span class="sc">*</span>P<span class="sc">-</span>d<span class="sc">*</span>P</span>
<span id="cb39-8"><a href="week-11.html#cb39-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="fu">c</span>(dN_dt, dP_dt)))  </span>
<span id="cb39-9"><a href="week-11.html#cb39-9" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb39-10"><a href="week-11.html#cb39-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb39-11"><a href="week-11.html#cb39-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-12"><a href="week-11.html#cb39-12" aria-hidden="true" tabindex="-1"></a>times <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">by =</span> <span class="fl">0.01</span>)  </span>
<span id="cb39-13"><a href="week-11.html#cb39-13" aria-hidden="true" tabindex="-1"></a>state <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">N =</span> <span class="dv">40</span>, <span class="at">P =</span> <span class="dv">20</span>)  </span>
<span id="cb39-14"><a href="week-11.html#cb39-14" aria-hidden="true" tabindex="-1"></a>parms <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">r =</span> <span class="fl">40.0</span>, <span class="at">K =</span> <span class="dv">60</span>, <span class="at">a =</span> <span class="fl">0.1</span>, <span class="at">e =</span> <span class="fl">0.1</span>, <span class="at">d =</span> <span class="fl">0.5</span>)  <span class="co"># r is chosen to be sufficiently large for time-scale separation</span></span>
<span id="cb39-15"><a href="week-11.html#cb39-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-16"><a href="week-11.html#cb39-16" aria-hidden="true" tabindex="-1"></a>pop_size <span class="ot">&lt;-</span> <span class="fu">ode</span>(<span class="at">func =</span> Prey_logistic_model, <span class="at">times =</span> times, <span class="at">y =</span> state, <span class="at">parms =</span> parms)</span>
<span id="cb39-17"><a href="week-11.html#cb39-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-18"><a href="week-11.html#cb39-18" aria-hidden="true" tabindex="-1"></a><span class="co"># population trajectories</span></span>
<span id="cb39-19"><a href="week-11.html#cb39-19" aria-hidden="true" tabindex="-1"></a>pop_size <span class="sc">%&gt;%</span></span>
<span id="cb39-20"><a href="week-11.html#cb39-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb39-21"><a href="week-11.html#cb39-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>time, <span class="at">names_to =</span> <span class="st">&quot;species&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;N&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-22"><a href="week-11.html#cb39-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> N, <span class="at">color =</span> species)) <span class="sc">+</span> </span>
<span id="cb39-23"><a href="week-11.html#cb39-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb39-24"><a href="week-11.html#cb39-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb39-25"><a href="week-11.html#cb39-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Time&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Population size&quot;</span>) <span class="sc">+</span></span>
<span id="cb39-26"><a href="week-11.html#cb39-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">100.5</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb39-27"><a href="week-11.html#cb39-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(pop_size[, <span class="sc">-</span><span class="dv">1</span>])<span class="sc">*</span><span class="fl">1.2</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb39-28"><a href="week-11.html#cb39-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">name =</span> <span class="cn">NULL</span>, <span class="at">palette =</span> <span class="st">&quot;Set1&quot;</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Prey&quot;</span>, <span class="st">&quot;Predator&quot;</span>), <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="11_Week_11_files/figure-html/unnamed-chunk-3-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="week-11.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># state-space diagram</span></span>
<span id="cb40-2"><a href="week-11.html#cb40-2" aria-hidden="true" tabindex="-1"></a>pop_size <span class="sc">%&gt;%</span></span>
<span id="cb40-3"><a href="week-11.html#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb40-4"><a href="week-11.html#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> N, <span class="at">y =</span> P)) <span class="sc">+</span> </span>
<span id="cb40-5"><a href="week-11.html#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;grey60&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> </span>
<span id="cb40-6"><a href="week-11.html#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">with</span>(<span class="fu">as.list</span>(parms), d<span class="sc">/</span>(e<span class="sc">*</span>a)), <span class="at">color =</span> <span class="st">&quot;#E41A1C&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb40-7"><a href="week-11.html#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="fu">with</span>(<span class="fu">as.list</span>(parms), <span class="sc">-</span>r<span class="sc">/</span>(a<span class="sc">*</span>K)), </span>
<span id="cb40-8"><a href="week-11.html#cb40-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">intercept =</span> <span class="fu">with</span>(<span class="fu">as.list</span>(parms), r<span class="sc">/</span>a),</span>
<span id="cb40-9"><a href="week-11.html#cb40-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;#377EB8&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb40-10"><a href="week-11.html#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">with</span>(<span class="fu">as.list</span>(parms), d<span class="sc">/</span>(e<span class="sc">*</span>a)),</span>
<span id="cb40-11"><a href="week-11.html#cb40-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> <span class="fu">with</span>(<span class="fu">as.list</span>(parms), <span class="sc">-</span>r<span class="sc">/</span>(a<span class="sc">*</span>K)<span class="sc">*</span>d<span class="sc">/</span>(e<span class="sc">*</span>a) <span class="sc">+</span> r<span class="sc">/</span>a)),</span>
<span id="cb40-12"><a href="week-11.html#cb40-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span> </span>
<span id="cb40-13"><a href="week-11.html#cb40-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb40-14"><a href="week-11.html#cb40-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;#E41A1C&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb40-15"><a href="week-11.html#cb40-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;#377EB8&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">+</span>           <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Prey&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Predator&quot;</span>) <span class="sc">+</span> </span>
<span id="cb40-16"><a href="week-11.html#cb40-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">100</span>))</span></code></pre></div>
<p><img src="11_Week_11_files/figure-html/unnamed-chunk-3-2.png" width="70%" style="display: block; margin: auto;" /></p>
<p>If we solve for the new predator growth equation derived under time-scale separation using the same parameter set and visualize the population trajectory, we will get almost exactly the same predator growth pattern as that in the original model.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="week-11.html#cb41-1" aria-hidden="true" tabindex="-1"></a>Time_scale_logistic <span class="ot">&lt;-</span> <span class="cf">function</span>(times, state, parms) {</span>
<span id="cb41-2"><a href="week-11.html#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">as.list</span>(<span class="fu">c</span>(state, parms)), {</span>
<span id="cb41-3"><a href="week-11.html#cb41-3" aria-hidden="true" tabindex="-1"></a>    dP_dt <span class="ot">=</span> (e<span class="sc">*</span>a<span class="sc">*</span>K<span class="sc">-</span>d)<span class="sc">*</span>P<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>((e<span class="sc">*</span>a<span class="sc">*</span>K<span class="sc">*</span>(a<span class="sc">/</span>r))<span class="sc">/</span>(e<span class="sc">*</span>a<span class="sc">*</span>K<span class="sc">-</span>d))<span class="sc">*</span>P)</span>
<span id="cb41-4"><a href="week-11.html#cb41-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="fu">c</span>(dP_dt)))  </span>
<span id="cb41-5"><a href="week-11.html#cb41-5" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb41-6"><a href="week-11.html#cb41-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-7"><a href="week-11.html#cb41-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-8"><a href="week-11.html#cb41-8" aria-hidden="true" tabindex="-1"></a>times <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb41-9"><a href="week-11.html#cb41-9" aria-hidden="true" tabindex="-1"></a>state <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">N =</span> <span class="dv">40</span>, <span class="at">P =</span> <span class="dv">20</span>) </span>
<span id="cb41-10"><a href="week-11.html#cb41-10" aria-hidden="true" tabindex="-1"></a>state_timescale <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">P =</span> <span class="dv">20</span>)  </span>
<span id="cb41-11"><a href="week-11.html#cb41-11" aria-hidden="true" tabindex="-1"></a>parms <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">r =</span> <span class="fl">40.0</span>, <span class="at">K =</span> <span class="dv">60</span>, <span class="at">a =</span> <span class="fl">0.1</span>, <span class="at">e =</span> <span class="fl">0.1</span>, <span class="at">d =</span> <span class="fl">0.5</span>)  <span class="co"># r is chosen to be sufficiently large for time-scale separation</span></span>
<span id="cb41-12"><a href="week-11.html#cb41-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-13"><a href="week-11.html#cb41-13" aria-hidden="true" tabindex="-1"></a>pop_size_original <span class="ot">&lt;-</span> <span class="fu">ode</span>(<span class="at">func =</span> Prey_logistic_model, <span class="at">times =</span> times, <span class="at">y =</span> state, <span class="at">parms =</span> parms)</span>
<span id="cb41-14"><a href="week-11.html#cb41-14" aria-hidden="true" tabindex="-1"></a>pop_size_timescale <span class="ot">&lt;-</span> <span class="fu">ode</span>(<span class="at">func =</span> Time_scale_logistic, <span class="at">times =</span> times, <span class="at">y =</span> state_timescale, <span class="at">parms =</span> parms)</span>
<span id="cb41-15"><a href="week-11.html#cb41-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-16"><a href="week-11.html#cb41-16" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the two predator population trajectories in the same figure</span></span>
<span id="cb41-17"><a href="week-11.html#cb41-17" aria-hidden="true" tabindex="-1"></a>pop_size_timescale <span class="sc">%&gt;%</span></span>
<span id="cb41-18"><a href="week-11.html#cb41-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb41-19"><a href="week-11.html#cb41-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">P_original =</span> pop_size_original[, <span class="st">&quot;P&quot;</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb41-20"><a href="week-11.html#cb41-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">P_timescale =</span> P) <span class="sc">%&gt;%</span></span>
<span id="cb41-21"><a href="week-11.html#cb41-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>time, <span class="at">names_to =</span> <span class="st">&quot;model&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;n&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-22"><a href="week-11.html#cb41-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> n, <span class="at">color =</span> model)) <span class="sc">+</span> </span>
<span id="cb41-23"><a href="week-11.html#cb41-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span></span>
<span id="cb41-24"><a href="week-11.html#cb41-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb41-25"><a href="week-11.html#cb41-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Time&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Population size&quot;</span>) <span class="sc">+</span></span>
<span id="cb41-26"><a href="week-11.html#cb41-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">100.5</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb41-27"><a href="week-11.html#cb41-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(pop_size_timescale[, <span class="sc">-</span><span class="dv">1</span>])<span class="sc">*</span><span class="fl">1.2</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb41-28"><a href="week-11.html#cb41-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">name =</span> <span class="cn">NULL</span>, <span class="at">palette =</span> <span class="st">&quot;Set2&quot;</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Original&quot;</span>, <span class="st">&quot;Time-scale&quot;</span>))</span></code></pre></div>
<p><img src="11_Week_11_files/figure-html/unnamed-chunk-4-1.png" width="70%" style="display: block; margin: auto;" />
<br></p>
<p>When you gradually shift <em>r</em> from small to large values, you can see that the population dynamics of predator and prey change quite dramatically. Some interesting patterns will arise!</p>
<iframe src="https://genchanghsu0115.shinyapps.io/Time_scale_sep_shinyapp/?showcase=0" width="800px" height="700px" data-external="1">
</iframe>
</div>
</div>
<div id="additional-readings-9" class="section level2 unnumbered">
<h2>Additional readings</h2>
<p>No additional readings this week.
<br></p>
</div>
<div id="assignments-9" class="section level2 unnumbered">
<h2>Assignments</h2>
<p>No assignments this week.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="week-10.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="week-12.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"info": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
