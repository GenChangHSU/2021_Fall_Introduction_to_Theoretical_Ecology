<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Week 15 | Introduction to Theoretical Ecology</title>
  <meta name="description" content="This is the course website for Introduction to Theoretical Ecology 2021 Fall at National Taiwan University." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Week 15 | Introduction to Theoretical Ecology" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://genchanghsu.github.io/2021_Fall_Introduction_to_Theoretical_Ecology/" />
  <meta property="og:image" content="https://genchanghsu.github.io/2021_Fall_Introduction_to_Theoretical_Ecology/bifurcation.gif" />
  <meta property="og:description" content="This is the course website for Introduction to Theoretical Ecology 2021 Fall at National Taiwan University." />
  <meta name="github-repo" content="GenChangHSU/2021_Fall_Introduction_to_Theoretical_Ecology" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Week 15 | Introduction to Theoretical Ecology" />
  
  <meta name="twitter:description" content="This is the course website for Introduction to Theoretical Ecology 2021 Fall at National Taiwan University." />
  <meta name="twitter:image" content="https://genchanghsu.github.io/2021_Fall_Introduction_to_Theoretical_Ecology/bifurcation.gif" />

<meta name="author" content="Instructor: Po-Ju Ke ~~~~~ Teaching Assistant: Gen-Chang Hsu" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="week-14.html"/>
<link rel="next" href="week-16.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introduction to Theoretical Ecology</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Course Information</a></li>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html"><i class="fa fa-check"></i>Syllabus</a></li>
<li class="chapter" data-level="" data-path="week-1.html"><a href="week-1.html"><i class="fa fa-check"></i>Week 1</a>
<ul>
<li class="chapter" data-level="" data-path="week-1.html"><a href="week-1.html#lecture-in-a-nutshell"><i class="fa fa-check"></i>Lecture in a nutshell</a></li>
<li class="chapter" data-level="" data-path="week-1.html"><a href="week-1.html#lab-demonstration"><i class="fa fa-check"></i>Lab demonstration</a></li>
<li class="chapter" data-level="" data-path="week-1.html"><a href="week-1.html#additional-readings"><i class="fa fa-check"></i>Additional readings</a></li>
<li class="chapter" data-level="" data-path="week-1.html"><a href="week-1.html#assignments"><i class="fa fa-check"></i>Assignments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-2.html"><a href="week-2.html"><i class="fa fa-check"></i>Week 2</a>
<ul>
<li class="chapter" data-level="" data-path="week-2.html"><a href="week-2.html#lecture-in-a-nutshell-1"><i class="fa fa-check"></i>Lecture in a nutshell</a></li>
<li class="chapter" data-level="" data-path="week-2.html"><a href="week-2.html#lab-demonstration-1"><i class="fa fa-check"></i>Lab demonstration</a></li>
<li class="chapter" data-level="" data-path="week-2.html"><a href="week-2.html#additional-readings-1"><i class="fa fa-check"></i>Additional readings</a></li>
<li class="chapter" data-level="" data-path="week-2.html"><a href="week-2.html#assignments-1"><i class="fa fa-check"></i>Assignments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-3.html"><a href="week-3.html"><i class="fa fa-check"></i>Week 3</a>
<ul>
<li class="chapter" data-level="" data-path="week-3.html"><a href="week-3.html#lecture-in-a-nutshell-2"><i class="fa fa-check"></i>Lecture in a nutshell</a></li>
<li class="chapter" data-level="" data-path="week-3.html"><a href="week-3.html#lab-demonstration-2"><i class="fa fa-check"></i>Lab demonstration</a></li>
<li class="chapter" data-level="" data-path="week-3.html"><a href="week-3.html#additional-readings-2"><i class="fa fa-check"></i>Additional readings</a></li>
<li class="chapter" data-level="" data-path="week-3.html"><a href="week-3.html#assignments-2"><i class="fa fa-check"></i>Assignments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-4.html"><a href="week-4.html"><i class="fa fa-check"></i>Week 4</a>
<ul>
<li class="chapter" data-level="" data-path="week-4.html"><a href="week-4.html#lecture-in-a-nutshell-3"><i class="fa fa-check"></i>Lecture in a nutshell</a></li>
<li class="chapter" data-level="" data-path="week-4.html"><a href="week-4.html#lab-demonstration-3"><i class="fa fa-check"></i>Lab demonstration</a></li>
<li class="chapter" data-level="" data-path="week-4.html"><a href="week-4.html#additional-readings-3"><i class="fa fa-check"></i>Additional readings</a></li>
<li class="chapter" data-level="" data-path="week-4.html"><a href="week-4.html#assignments-3"><i class="fa fa-check"></i>Assignments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-5.html"><a href="week-5.html"><i class="fa fa-check"></i>Week 5</a>
<ul>
<li class="chapter" data-level="" data-path="week-5.html"><a href="week-5.html#lecture-in-a-nutshell-4"><i class="fa fa-check"></i>Lecture in a nutshell</a></li>
<li class="chapter" data-level="" data-path="week-5.html"><a href="week-5.html#lab-demonstration-4"><i class="fa fa-check"></i>Lab demonstration</a></li>
<li class="chapter" data-level="" data-path="week-5.html"><a href="week-5.html#additional-readings-4"><i class="fa fa-check"></i>Additional readings</a></li>
<li class="chapter" data-level="" data-path="week-5.html"><a href="week-5.html#assignments-4"><i class="fa fa-check"></i>Assignments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-6.html"><a href="week-6.html"><i class="fa fa-check"></i>Week 6</a>
<ul>
<li class="chapter" data-level="" data-path="week-6.html"><a href="week-6.html#lecture-in-a-nutshell-5"><i class="fa fa-check"></i>Lecture in a nutshell</a></li>
<li class="chapter" data-level="" data-path="week-6.html"><a href="week-6.html#lab-demonstration-5"><i class="fa fa-check"></i>Lab demonstration</a></li>
<li class="chapter" data-level="" data-path="week-6.html"><a href="week-6.html#additional-readings-5"><i class="fa fa-check"></i>Additional readings</a></li>
<li class="chapter" data-level="" data-path="week-6.html"><a href="week-6.html#assignments-5"><i class="fa fa-check"></i>Assignments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-7.html"><a href="week-7.html"><i class="fa fa-check"></i>Week 7</a>
<ul>
<li class="chapter" data-level="" data-path="week-7.html"><a href="week-7.html#lecture-in-a-nutshell-6"><i class="fa fa-check"></i>Lecture in a nutshell</a></li>
<li class="chapter" data-level="" data-path="week-7.html"><a href="week-7.html#lab-demonstration-6"><i class="fa fa-check"></i>Lab demonstration</a></li>
<li class="chapter" data-level="" data-path="week-7.html"><a href="week-7.html#additional-readings-6"><i class="fa fa-check"></i>Additional readings</a></li>
<li class="chapter" data-level="" data-path="week-7.html"><a href="week-7.html#assignments-6"><i class="fa fa-check"></i>Assignments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-8.html"><a href="week-8.html"><i class="fa fa-check"></i>Week 8</a>
<ul>
<li class="chapter" data-level="" data-path="week-8.html"><a href="week-8.html#lecture-in-a-nutshell-7"><i class="fa fa-check"></i>Lecture in a nutshell</a></li>
<li class="chapter" data-level="" data-path="week-8.html"><a href="week-8.html#lab-demonstration-7"><i class="fa fa-check"></i>Lab demonstration</a></li>
<li class="chapter" data-level="" data-path="week-8.html"><a href="week-8.html#additional-readings-7"><i class="fa fa-check"></i>Additional readings</a></li>
<li class="chapter" data-level="" data-path="week-8.html"><a href="week-8.html#assignments-7"><i class="fa fa-check"></i>Assignments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-9.html"><a href="week-9.html"><i class="fa fa-check"></i>Week 9</a></li>
<li class="chapter" data-level="" data-path="week-10.html"><a href="week-10.html"><i class="fa fa-check"></i>Week 10</a>
<ul>
<li class="chapter" data-level="" data-path="week-10.html"><a href="week-10.html#lecture-in-a-nutshell-8"><i class="fa fa-check"></i>Lecture in a nutshell</a></li>
<li class="chapter" data-level="" data-path="week-10.html"><a href="week-10.html#lab-demonstration-8"><i class="fa fa-check"></i>Lab demonstration</a></li>
<li class="chapter" data-level="" data-path="week-10.html"><a href="week-10.html#additional-readings-8"><i class="fa fa-check"></i>Additional readings</a></li>
<li class="chapter" data-level="" data-path="week-10.html"><a href="week-10.html#assignments-8"><i class="fa fa-check"></i>Assignments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-11.html"><a href="week-11.html"><i class="fa fa-check"></i>Week 11</a>
<ul>
<li class="chapter" data-level="" data-path="week-11.html"><a href="week-11.html#lecture-in-a-nutshell-9"><i class="fa fa-check"></i>Lecture in a nutshell</a></li>
<li class="chapter" data-level="" data-path="week-11.html"><a href="week-11.html#lab-demonstration-9"><i class="fa fa-check"></i>Lab demonstration</a>
<ul>
<li class="chapter" data-level="" data-path="week-11.html"><a href="week-11.html#special-topic-time-scale-separation"><i class="fa fa-check"></i>Special topic: time-scale separation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-11.html"><a href="week-11.html#additional-readings-9"><i class="fa fa-check"></i>Additional readings</a></li>
<li class="chapter" data-level="" data-path="week-11.html"><a href="week-11.html#assignments-9"><i class="fa fa-check"></i>Assignments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-12.html"><a href="week-12.html"><i class="fa fa-check"></i>Week 12</a>
<ul>
<li class="chapter" data-level="" data-path="week-12.html"><a href="week-12.html#lecture-in-a-nutshell-10"><i class="fa fa-check"></i>Lecture in a nutshell</a></li>
<li class="chapter" data-level="" data-path="week-12.html"><a href="week-12.html#lab-demonstration-10"><i class="fa fa-check"></i>Lab demonstration</a>
<ul>
<li class="chapter" data-level="" data-path="week-12.html"><a href="week-12.html#part-1---r-rule"><i class="fa fa-check"></i>Part 1 - R* rule</a></li>
<li class="chapter" data-level="" data-path="week-12.html"><a href="week-12.html#part-2---tilmans-resource-ratio-hypothesis"><i class="fa fa-check"></i>Part 2 - Tilman’s resource ratio hypothesis</a></li>
<li class="chapter" data-level="" data-path="week-12.html"><a href="week-12.html#part-3---relative-nonlinearity"><i class="fa fa-check"></i>Part 3 - Relative nonlinearity</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-12.html"><a href="week-12.html#additional-readings-10"><i class="fa fa-check"></i>Additional readings</a></li>
<li class="chapter" data-level="" data-path="week-12.html"><a href="week-12.html#assignments-10"><i class="fa fa-check"></i>Assignments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-13.html"><a href="week-13.html"><i class="fa fa-check"></i>Week 13</a>
<ul>
<li class="chapter" data-level="" data-path="week-13.html"><a href="week-13.html#lecture-in-a-nutshell-11"><i class="fa fa-check"></i>Lecture in a nutshell</a></li>
<li class="chapter" data-level="" data-path="week-13.html"><a href="week-13.html#lab-demonstration-11"><i class="fa fa-check"></i>Lab demonstration</a></li>
<li class="chapter" data-level="" data-path="week-13.html"><a href="week-13.html#additional-readings-11"><i class="fa fa-check"></i>Additional readings</a></li>
<li class="chapter" data-level="" data-path="week-13.html"><a href="week-13.html#assignments-11"><i class="fa fa-check"></i>Assignments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-14.html"><a href="week-14.html"><i class="fa fa-check"></i>Week 14</a>
<ul>
<li class="chapter" data-level="" data-path="week-14.html"><a href="week-14.html#lecture-in-a-nutshell-12"><i class="fa fa-check"></i>Lecture in a nutshell</a></li>
<li class="chapter" data-level="" data-path="week-14.html"><a href="week-14.html#lab-demonstration-12"><i class="fa fa-check"></i>Lab demonstration</a></li>
<li class="chapter" data-level="" data-path="week-14.html"><a href="week-14.html#additional-readings-12"><i class="fa fa-check"></i>Additional readings</a></li>
<li class="chapter" data-level="" data-path="week-14.html"><a href="week-14.html#assignments-12"><i class="fa fa-check"></i>Assignments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-15.html"><a href="week-15.html"><i class="fa fa-check"></i>Week 15</a>
<ul>
<li class="chapter" data-level="" data-path="week-15.html"><a href="week-15.html#lecture-review"><i class="fa fa-check"></i>Lecture review</a></li>
<li class="chapter" data-level="" data-path="week-15.html"><a href="week-15.html#lab-review"><i class="fa fa-check"></i>Lab review</a>
<ul>
<li class="chapter" data-level="" data-path="week-15.html"><a href="week-15.html#desolve-and-numerical-integration"><i class="fa fa-check"></i>1. deSolve and numerical integration</a></li>
<li class="chapter" data-level="" data-path="week-15.html"><a href="week-15.html#for-loops"><i class="fa fa-check"></i>2. for loops</a></li>
<li class="chapter" data-level="" data-path="week-15.html"><a href="week-15.html#matrix-multiplication-and-eigenanalysis"><i class="fa fa-check"></i>3. Matrix multiplication and eigenanalysis</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-15.html"><a href="week-15.html#additional-readings-13"><i class="fa fa-check"></i>Additional readings</a></li>
<li class="chapter" data-level="" data-path="week-15.html"><a href="week-15.html#assignments-13"><i class="fa fa-check"></i>Assignments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-16.html"><a href="week-16.html"><i class="fa fa-check"></i>Week 16</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Site built with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Theoretical Ecology</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="week-15" class="section level1 unnumbered">
<h1>Week 15</h1>
<div style="font-size: 28pt">
<strong><em>Course review &amp; open discussion</em></strong>
</div>
<div id="lecture-review" class="section level2 unnumbered">
<h2>Lecture review</h2>
<p><br></p>
</div>
<div id="lab-review" class="section level2 unnumbered">
<h2>Lab review</h2>
<p>Throughout the lab sections this semester, we have been focusing largely on solving differential equations using the package <code>deSolve</code> and visualize the system dynamics with ggplots. We have also used for loops to model discrete-time population growth. Lastly, we have analyzed age-structured models using matrix multiplication as well as eigenanalysis to estimate the asymptotic growth rate and stable age distribution.</p>
<p>Below is a brief summary of the key points regarding these modeling techniques:</p>
<div id="desolve-and-numerical-integration" class="section level3 unnumbered">
<h3>1. deSolve and numerical integration</h3>
<p>There are two main steps for solving ode’s with <code>deSolve</code>:</p>
<p><span id="aaa" style="display: block; margin-top: -10px; margin-left: 90px">Model specification: Create a function specifying your model structure, that is, a set of differential equations</span></p>
<p><span id="bbb" style="display: block; margin-top: -10px; margin-left: 90px">Model application: Set the time steps, initial conditions, and model parameters and run the <code>ode()</code> function to solve the system of differential equations</span></p>
<style>

p span#aaa:before { 
  content: "Step 1. "; 
  display: inline-block;
  margin-left: -3.5em;
  margin-right: 0.3em;
}

p span#bbb:before { 
  content: "Step 2. "; 
  display: inline-block;
  margin-left: -3.5em;
  margin-right: 0.3em;
}

d-article table.lightable-paper {
  margin-bottom: 0px; 
}

</style>
<p>Here is an ode example using the Lotka-Volterra competition model:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="week-15.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(deSolve)</span>
<span id="cb54-2"><a href="week-15.html#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="week-15.html#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="do">### (1) Model specification</span></span>
<span id="cb54-4"><a href="week-15.html#cb54-4" aria-hidden="true" tabindex="-1"></a>LV_competition_model <span class="ot">&lt;-</span> <span class="cf">function</span>(times, state, parms) {</span>
<span id="cb54-5"><a href="week-15.html#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">as.list</span>(<span class="fu">c</span>(state, parms)), {</span>
<span id="cb54-6"><a href="week-15.html#cb54-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb54-7"><a href="week-15.html#cb54-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># system of differential equations</span></span>
<span id="cb54-8"><a href="week-15.html#cb54-8" aria-hidden="true" tabindex="-1"></a>    dN1_dt <span class="ot">=</span> N1<span class="sc">*</span>(r1<span class="sc">-</span>a11<span class="sc">*</span>N1<span class="sc">-</span>a12<span class="sc">*</span>N2)  </span>
<span id="cb54-9"><a href="week-15.html#cb54-9" aria-hidden="true" tabindex="-1"></a>    dN2_dt <span class="ot">=</span> N2<span class="sc">*</span>(r2<span class="sc">-</span>a22<span class="sc">*</span>N2<span class="sc">-</span>a21<span class="sc">*</span>N1)</span>
<span id="cb54-10"><a href="week-15.html#cb54-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb54-11"><a href="week-15.html#cb54-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># return the integration results (the objects need to be in the same order specified above)</span></span>
<span id="cb54-12"><a href="week-15.html#cb54-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="fu">c</span>(dN1_dt, dN2_dt)))</span>
<span id="cb54-13"><a href="week-15.html#cb54-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb54-14"><a href="week-15.html#cb54-14" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb54-15"><a href="week-15.html#cb54-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb54-16"><a href="week-15.html#cb54-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb54-17"><a href="week-15.html#cb54-17" aria-hidden="true" tabindex="-1"></a><span class="do">### (2) Model application</span></span>
<span id="cb54-18"><a href="week-15.html#cb54-18" aria-hidden="true" tabindex="-1"></a><span class="co"># parameter setup</span></span>
<span id="cb54-19"><a href="week-15.html#cb54-19" aria-hidden="true" tabindex="-1"></a>times <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb54-20"><a href="week-15.html#cb54-20" aria-hidden="true" tabindex="-1"></a>state <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">N1 =</span> <span class="dv">10</span>, <span class="at">N2 =</span> <span class="dv">10</span>)</span>
<span id="cb54-21"><a href="week-15.html#cb54-21" aria-hidden="true" tabindex="-1"></a>parms <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">r1 =</span> <span class="fl">1.4</span>, <span class="at">r2 =</span> <span class="fl">1.2</span>, <span class="at">a11 =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">200</span>, <span class="at">a21 =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">400</span>, <span class="at">a22 =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">200</span>, <span class="at">a12 =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">300</span>)</span>
<span id="cb54-22"><a href="week-15.html#cb54-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-23"><a href="week-15.html#cb54-23" aria-hidden="true" tabindex="-1"></a><span class="co"># run the ode solver</span></span>
<span id="cb54-24"><a href="week-15.html#cb54-24" aria-hidden="true" tabindex="-1"></a>pop_size <span class="ot">&lt;-</span> <span class="fu">ode</span>(<span class="at">func =</span> LV_competition_model, <span class="at">times =</span> times, <span class="at">y =</span> state, <span class="at">parms =</span> parms)</span>
<span id="cb54-25"><a href="week-15.html#cb54-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-26"><a href="week-15.html#cb54-26" aria-hidden="true" tabindex="-1"></a><span class="do">### Take a look at the results</span></span>
<span id="cb54-27"><a href="week-15.html#cb54-27" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pop_size)</span></code></pre></div>
<pre><code>##      time       N1       N2
## [1,]  0.0 10.00000 10.00000
## [2,]  0.1 11.40115 11.18554
## [3,]  0.2 12.98354 12.49917
## [4,]  0.3 14.76632 13.95156
## [5,]  0.4 16.76949 15.55348
## [6,]  0.5 19.01355 17.31557</code></pre>
</div>
<div id="for-loops" class="section level3 unnumbered">
<h3>2. for loops</h3>
<p>The key to using for loops is to identify what you would like to iterate over (e.g., time) and how many iterations there are (e.g., 100 iterations). Also, we will create an object beforehand to store the results of each for loop iteration.</p>
<p>Here is a for loop example using the discrete logistic growth model:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="week-15.html#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb56-2"><a href="week-15.html#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="week-15.html#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="do">### The discrete logistic growth equation and parameter setup</span></span>
<span id="cb56-4"><a href="week-15.html#cb56-4" aria-hidden="true" tabindex="-1"></a>log_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(r, N, K){N <span class="sc">+</span> r<span class="sc">*</span>N<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>N<span class="sc">/</span>K)}  </span>
<span id="cb56-5"><a href="week-15.html#cb56-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-6"><a href="week-15.html#cb56-6" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fl">1.8</span></span>
<span id="cb56-7"><a href="week-15.html#cb56-7" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb56-8"><a href="week-15.html#cb56-8" aria-hidden="true" tabindex="-1"></a>N0 <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb56-9"><a href="week-15.html#cb56-9" aria-hidden="true" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb56-10"><a href="week-15.html#cb56-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-11"><a href="week-15.html#cb56-11" aria-hidden="true" tabindex="-1"></a><span class="do">### Create an empty object to store the for loop results</span></span>
<span id="cb56-12"><a href="week-15.html#cb56-12" aria-hidden="true" tabindex="-1"></a>pop_size <span class="ot">&lt;-</span> <span class="fu">numeric</span>(time)</span>
<span id="cb56-13"><a href="week-15.html#cb56-13" aria-hidden="true" tabindex="-1"></a>pop_size[<span class="dv">1</span>] <span class="ot">&lt;-</span> N0</span>
<span id="cb56-14"><a href="week-15.html#cb56-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-15"><a href="week-15.html#cb56-15" aria-hidden="true" tabindex="-1"></a><span class="do">### Run the for loop </span></span>
<span id="cb56-16"><a href="week-15.html#cb56-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>time) {pop_size[i] <span class="ot">&lt;-</span> <span class="fu">log_fun</span>(<span class="at">r =</span> r, <span class="at">N =</span> pop_size[i <span class="sc">-</span> <span class="dv">1</span>], <span class="at">K =</span> K)}</span>
<span id="cb56-17"><a href="week-15.html#cb56-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-18"><a href="week-15.html#cb56-18" aria-hidden="true" tabindex="-1"></a><span class="do">### Organize the for loop results</span></span>
<span id="cb56-19"><a href="week-15.html#cb56-19" aria-hidden="true" tabindex="-1"></a>pop_data <span class="ot">&lt;-</span> pop_size <span class="sc">%&gt;%</span> </span>
<span id="cb56-20"><a href="week-15.html#cb56-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb56-21"><a href="week-15.html#cb56-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(., <span class="at">pop_size =</span> <span class="st">`</span><span class="at">.</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-22"><a href="week-15.html#cb56-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time =</span> <span class="dv">0</span><span class="sc">:</span>(time<span class="dv">-1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb56-23"><a href="week-15.html#cb56-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(time)</span>
<span id="cb56-24"><a href="week-15.html#cb56-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-25"><a href="week-15.html#cb56-25" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pop_data)</span></code></pre></div>
<pre><code>##   time  pop_size
## 1    0  10.00000
## 2    1  27.64000
## 3    2  74.64171
## 4    3 188.93980
## 5    4 400.51775
## 6    5 543.95762</code></pre>
</div>
<div id="matrix-multiplication-and-eigenanalysis" class="section level3 unnumbered">
<h3>3. Matrix multiplication and eigenanalysis</h3>
<p>In R, we use <code>%*%</code> (not <code>*</code>!) to do matrix multiplication. Make sure the two matrices are <strong>compatible</strong>: the number of columns in the first matrix should be the same as the number of rows in the second matrix. If necessary, use <code>t()</code> to transpose the matrix so that the two matrices are compatible for multiplication.</p>
<p>To perform eigenanalysis on a square matrix, simply pass the matrix into the function <code>eigen()</code> and store the results to an object. You can then access the eigenvalues and eigenvectors via <code>object_name$values</code> and <code>object_name$vectors</code>.</p>
<p>Here is a Leslie matrix example:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="week-15.html#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb58-2"><a href="week-15.html#cb58-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-3"><a href="week-15.html#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="do">### Leslie matrix and initial age classes</span></span>
<span id="cb58-4"><a href="week-15.html#cb58-4" aria-hidden="true" tabindex="-1"></a>leslie_mtrx <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">5</span>,</span>
<span id="cb58-5"><a href="week-15.html#cb58-5" aria-hidden="true" tabindex="-1"></a>                               <span class="fl">0.5</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb58-6"><a href="week-15.html#cb58-6" aria-hidden="true" tabindex="-1"></a>                               <span class="dv">0</span>, <span class="fl">0.3</span>, <span class="dv">0</span>),</span>
<span id="cb58-7"><a href="week-15.html#cb58-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">nrow =</span> <span class="dv">3</span>, </span>
<span id="cb58-8"><a href="week-15.html#cb58-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb58-9"><a href="week-15.html#cb58-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">byrow =</span> T)</span>
<span id="cb58-10"><a href="week-15.html#cb58-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-11"><a href="week-15.html#cb58-11" aria-hidden="true" tabindex="-1"></a>initial_age <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb58-12"><a href="week-15.html#cb58-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-13"><a href="week-15.html#cb58-13" aria-hidden="true" tabindex="-1"></a><span class="do">### for loop and matrix multiplication</span></span>
<span id="cb58-14"><a href="week-15.html#cb58-14" aria-hidden="true" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb58-15"><a href="week-15.html#cb58-15" aria-hidden="true" tabindex="-1"></a>pop_size <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Age1 =</span> <span class="fu">numeric</span>(time<span class="sc">+</span><span class="dv">1</span>),</span>
<span id="cb58-16"><a href="week-15.html#cb58-16" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Age2 =</span> <span class="fu">numeric</span>(time<span class="sc">+</span><span class="dv">1</span>),</span>
<span id="cb58-17"><a href="week-15.html#cb58-17" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Age3 =</span> <span class="fu">numeric</span>(time<span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb58-18"><a href="week-15.html#cb58-18" aria-hidden="true" tabindex="-1"></a>pop_size[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> initial_age</span>
<span id="cb58-19"><a href="week-15.html#cb58-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-20"><a href="week-15.html#cb58-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>time) {</span>
<span id="cb58-21"><a href="week-15.html#cb58-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># use &quot;%*%&quot; for matrix multiplication</span></span>
<span id="cb58-22"><a href="week-15.html#cb58-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># &quot;leslie_mtrx&quot; (3-by-3) is compatible with &quot;as.matrix(t(pop_size[i, ]))&quot; (3-by-1)</span></span>
<span id="cb58-23"><a href="week-15.html#cb58-23" aria-hidden="true" tabindex="-1"></a>  pop_size[i<span class="sc">+</span><span class="dv">1</span>, ] <span class="ot">&lt;-</span> leslie_mtrx <span class="sc">%*%</span> <span class="fu">as.matrix</span>(<span class="fu">t</span>(pop_size[i, ]))</span>
<span id="cb58-24"><a href="week-15.html#cb58-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb58-25"><a href="week-15.html#cb58-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-26"><a href="week-15.html#cb58-26" aria-hidden="true" tabindex="-1"></a><span class="do">### Organize the for loop results </span></span>
<span id="cb58-27"><a href="week-15.html#cb58-27" aria-hidden="true" tabindex="-1"></a>pop_size <span class="ot">&lt;-</span> pop_size <span class="sc">%&gt;%</span> </span>
<span id="cb58-28"><a href="week-15.html#cb58-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>() <span class="sc">%&gt;%</span></span>
<span id="cb58-29"><a href="week-15.html#cb58-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Total_N =</span> <span class="fu">rowSums</span>(.), </span>
<span id="cb58-30"><a href="week-15.html#cb58-30" aria-hidden="true" tabindex="-1"></a>         <span class="at">Time =</span> <span class="dv">0</span><span class="sc">:</span>time) <span class="sc">%&gt;%</span></span>
<span id="cb58-31"><a href="week-15.html#cb58-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Time)</span>
<span id="cb58-32"><a href="week-15.html#cb58-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-33"><a href="week-15.html#cb58-33" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">round</span>(pop_size)) </span></code></pre></div>
<pre><code>##   Time Age1 Age2 Age3 Total_N
## 1    0   10    0    0      10
## 2    1    0    5    0       5
## 3    2    5    0    2       7
## 4    3    8    2    0      10
## 5    4    2    4    1       7
## 6    5    8    1    1      10</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="week-15.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Eigenanalysis of the Leslie matrix</span></span>
<span id="cb60-2"><a href="week-15.html#cb60-2" aria-hidden="true" tabindex="-1"></a>eigen_out <span class="ot">&lt;-</span> <span class="fu">eigen</span>(leslie_mtrx)</span>
<span id="cb60-3"><a href="week-15.html#cb60-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-4"><a href="week-15.html#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="co"># dominant eigenvalue</span></span>
<span id="cb60-5"><a href="week-15.html#cb60-5" aria-hidden="true" tabindex="-1"></a>eigen_out<span class="sc">$</span>values[<span class="dv">1</span>] </span></code></pre></div>
<pre><code>## [1] 1.089991+0i</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="week-15.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># corresponding eigenvector</span></span>
<span id="cb62-2"><a href="week-15.html#cb62-2" aria-hidden="true" tabindex="-1"></a>eigen_out<span class="sc">$</span>vectors[, <span class="dv">1</span>]</span></code></pre></div>
<pre><code>## [1] 0.9030054+0i 0.4142263+0i 0.1140082+0i</code></pre>
<p><br></p>
</div>
</div>
<div id="additional-readings-13" class="section level2 unnumbered">
<h2>Additional readings</h2>
<p><br></p>
</div>
<div id="assignments-13" class="section level2 unnumbered">
<h2>Assignments</h2>
<p>No assignments this week.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="week-14.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="week-16.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"info": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
