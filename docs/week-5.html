<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Week 5 | Introduction to Theoretical Ecology</title>
  <meta name="description" content="This is the course website for Introduction to Theoretical Ecology 2021 Fall at National Taiwan University." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Week 5 | Introduction to Theoretical Ecology" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://genchanghsu.github.io/2021_Fall_Introduction_to_Theoretical_Ecology/" />
  <meta property="og:image" content="https://genchanghsu.github.io/2021_Fall_Introduction_to_Theoretical_Ecology/bifurcation.gif" />
  <meta property="og:description" content="This is the course website for Introduction to Theoretical Ecology 2021 Fall at National Taiwan University." />
  <meta name="github-repo" content="GenChangHSU/2021_Fall_Introduction_to_Theoretical_Ecology" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Week 5 | Introduction to Theoretical Ecology" />
  
  <meta name="twitter:description" content="This is the course website for Introduction to Theoretical Ecology 2021 Fall at National Taiwan University." />
  <meta name="twitter:image" content="https://genchanghsu.github.io/2021_Fall_Introduction_to_Theoretical_Ecology/bifurcation.gif" />

<meta name="author" content="Instructor: Po-Ju Ke ~~~~~ Teaching Assistant: Gen-Chang Hsu" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="week-4.html"/>
<link rel="next" href="week-6.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introduction to Theoretical Ecology</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Course Information</a></li>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html"><i class="fa fa-check"></i>Syllabus</a></li>
<li class="chapter" data-level="" data-path="week-1.html"><a href="week-1.html"><i class="fa fa-check"></i>Week 1</a>
<ul>
<li class="chapter" data-level="" data-path="week-1.html"><a href="week-1.html#lecture-in-a-nutshell"><i class="fa fa-check"></i>Lecture in a nutshell</a></li>
<li class="chapter" data-level="" data-path="week-1.html"><a href="week-1.html#lab-demonstration"><i class="fa fa-check"></i>Lab demonstration</a></li>
<li class="chapter" data-level="" data-path="week-1.html"><a href="week-1.html#additional-readings"><i class="fa fa-check"></i>Additional readings</a></li>
<li class="chapter" data-level="" data-path="week-1.html"><a href="week-1.html#assignments"><i class="fa fa-check"></i>Assignments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-2.html"><a href="week-2.html"><i class="fa fa-check"></i>Week 2</a>
<ul>
<li class="chapter" data-level="" data-path="week-2.html"><a href="week-2.html#lecture-in-a-nutshell-1"><i class="fa fa-check"></i>Lecture in a nutshell</a></li>
<li class="chapter" data-level="" data-path="week-2.html"><a href="week-2.html#lab-demonstration-1"><i class="fa fa-check"></i>Lab demonstration</a></li>
<li class="chapter" data-level="" data-path="week-2.html"><a href="week-2.html#additional-readings-1"><i class="fa fa-check"></i>Additional readings</a></li>
<li class="chapter" data-level="" data-path="week-2.html"><a href="week-2.html#assignments-1"><i class="fa fa-check"></i>Assignments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-3.html"><a href="week-3.html"><i class="fa fa-check"></i>Week 3</a>
<ul>
<li class="chapter" data-level="" data-path="week-3.html"><a href="week-3.html#lecture-in-a-nutshell-2"><i class="fa fa-check"></i>Lecture in a nutshell</a></li>
<li class="chapter" data-level="" data-path="week-3.html"><a href="week-3.html#lab-demonstration-2"><i class="fa fa-check"></i>Lab demonstration</a></li>
<li class="chapter" data-level="" data-path="week-3.html"><a href="week-3.html#additional-readings-2"><i class="fa fa-check"></i>Additional readings</a></li>
<li class="chapter" data-level="" data-path="week-3.html"><a href="week-3.html#assignments-2"><i class="fa fa-check"></i>Assignments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-4.html"><a href="week-4.html"><i class="fa fa-check"></i>Week 4</a>
<ul>
<li class="chapter" data-level="" data-path="week-4.html"><a href="week-4.html#lecture-in-a-nutshell-3"><i class="fa fa-check"></i>Lecture in a nutshell</a></li>
<li class="chapter" data-level="" data-path="week-4.html"><a href="week-4.html#lab-demonstration-3"><i class="fa fa-check"></i>Lab demonstration</a></li>
<li class="chapter" data-level="" data-path="week-4.html"><a href="week-4.html#additional-readings-3"><i class="fa fa-check"></i>Additional readings</a></li>
<li class="chapter" data-level="" data-path="week-4.html"><a href="week-4.html#assignments-3"><i class="fa fa-check"></i>Assignments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-5.html"><a href="week-5.html"><i class="fa fa-check"></i>Week 5</a>
<ul>
<li class="chapter" data-level="" data-path="week-5.html"><a href="week-5.html#lecture-in-a-nutshell-4"><i class="fa fa-check"></i>Lecture in a nutshell</a></li>
<li class="chapter" data-level="" data-path="week-5.html"><a href="week-5.html#lab-demonstration-4"><i class="fa fa-check"></i>Lab demonstration</a></li>
<li class="chapter" data-level="" data-path="week-5.html"><a href="week-5.html#additional-readings-4"><i class="fa fa-check"></i>Additional readings</a></li>
<li class="chapter" data-level="" data-path="week-5.html"><a href="week-5.html#assignments-4"><i class="fa fa-check"></i>Assignments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-6.html"><a href="week-6.html"><i class="fa fa-check"></i>Week 6</a>
<ul>
<li class="chapter" data-level="" data-path="week-6.html"><a href="week-6.html#lecture-in-a-nutshell-5"><i class="fa fa-check"></i>Lecture in a nutshell</a></li>
<li class="chapter" data-level="" data-path="week-6.html"><a href="week-6.html#lab-demonstration-5"><i class="fa fa-check"></i>Lab demonstration</a></li>
<li class="chapter" data-level="" data-path="week-6.html"><a href="week-6.html#additional-readings-5"><i class="fa fa-check"></i>Additional readings</a></li>
<li class="chapter" data-level="" data-path="week-6.html"><a href="week-6.html#assignments-5"><i class="fa fa-check"></i>Assignments</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Site built with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Theoretical Ecology</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="week-5" class="section level1 unnumbered">
<h1>Week 5</h1>
<div style="font-size: 28pt">
<strong><em>Age-structured models</em></strong>
</div>
<div id="lecture-in-a-nutshell-4" class="section level2 unnumbered">
<h2>Lecture in a nutshell</h2>
<ul>
<li><strong>Model derivation:</strong>
<ol style="list-style-type: decimal">
<li>Model diagram: a sequence of age classes connected through arrows of survival probability (<span class="math inline">\(Si\)</span>) and fecundity (<span class="math inline">\(fi\)</span>)</li>
<li>Assumptions:
<ul>
<li>Closed population</li>
<li>Individuals within each age class are identical</li>
<li>Critical rates are age-dependent <strong>BUT</strong> not time- or density-dependent (unlimited resources)</li>
<li>Discrete age classes; individuals do not remain in the same age class over time</li>
</ul></li>
</ol></li>
</ul>
<div style="height:1px ;">
<br>
</div>
<ul>
<li><strong>Model dynamics (linear algebra):</strong>
<ol style="list-style-type: decimal">
<li>A simple example:
<ul>
<li>Age class at time <em>t</em>: <span class="math inline">\(\vec{n}_{t} = \begin{vmatrix}n_{1.t} \\ n_{2.t} \\ n_{3.t} \end{vmatrix}\)</span></li>
<li>Leslie matrix <span class="math inline">\(L\)</span> (transition matrix): <span class="math inline">\(\begin{vmatrix}f_{1} &amp; f_{2} &amp; f_{3}\\S_{1} &amp; 0 &amp; 0\\0 &amp; S_{2} &amp; 0 \end{vmatrix}\)</span></li>
<li>Age class at time <em>t+1</em>: <span class="math inline">\(\vec{n}_{t+1} = L \cdot \vec{n}_{t}\)</span></li>
</ul></li>
<li>Eigenanalysis: eigenvalues (<span class="math inline">\(\lambda\)</span>) and eigenvectors (<span class="math inline">\(\vec{u}\)</span>)
<ul>
<li><span class="math inline">\(L\vec{u} = \lambda\vec{u}; (L - \lambda I)\vec{u} = 0; det|L - \lambda I| = 0\)</span></li>
<li>Solve for <span class="math inline">\(\lambda\)</span> and find the corresponding <span class="math inline">\(\vec{u}\)</span></li>
</ul></li>
<li>Eigendecomposition (for diagonalizable matrix): <span class="math inline">\(L = ADA^{-1}; A = \begin{vmatrix}\vec{u}_{1} &amp; \vec{u}_{2} &amp; \vec{u}_{3} \end{vmatrix}; D = \begin{vmatrix}\lambda_{1} &amp; 0 &amp; 0\\0 &amp; \lambda_{2} &amp; 0\\0 &amp; 0 &amp; \lambda_{3} \end{vmatrix}\)</span></li>
<li><span class="math inline">\(L^{t} = AD^{t}A^{-1} \approx A\lambda_{1}^{t}A^{-1}\)</span> (<span class="math inline">\(\lambda_{1}\)</span> is the dominant eigenvalue)</li>
<li>The long-term dynamics of Leslie matrix are determined by:
<ul>
<li>The dominant eigenvalue <span class="math inline">\(\lambda_{1}\)</span>: finite rate of increase (asymptotic growth rate)</li>
<li>The dominant eigenvector <span class="math inline">\(\vec{u}_{1}\)</span>: stable age distribution
<div style="height:1px ;">
<br>
</div></li>
</ul></li>
<li>For an <span class="math inline">\(n \times n\)</span> Leslie matrix, the characteristic equation (Euler-Lotka equation) can be written as: <span class="math inline">\(\sum_{i}^{n} S_{i}f{i}\lambda^{-i} = 1\)</span></li>
</ol></li>
</ul>
<div style="height:1px ;">
<br>
</div>
<ul>
<li><strong>Stage-structured models:</strong>
<ol style="list-style-type: decimal">
<li>Stages are arbitrarily defined by the user</li>
<li>Individuals can remain in the same stage class or even regress back to previous stage class</li>
</ol></li>
</ul>
<div style="height:1px ;">
<br>
</div>
<p><br></p>
</div>
<div id="lab-demonstration-4" class="section level2 unnumbered">
<h2>Lab demonstration</h2>
<p>In this lab, we will be analyzing a simple Leslie matrix using for loops + matrix algebra, comparing the results with those obtained via eigenanalysis, and visualizing the population dynamics and age distribution.</p>
<p><strong>Part 1 - Analyzing Leslie matrix</strong></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="week-5.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb11-2"><a href="week-5.html#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="week-5.html#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="do">### Leslie matrix and initial age classes</span></span>
<span id="cb11-4"><a href="week-5.html#cb11-4" aria-hidden="true" tabindex="-1"></a>leslie_mtrx <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">5</span>,</span>
<span id="cb11-5"><a href="week-5.html#cb11-5" aria-hidden="true" tabindex="-1"></a>                               <span class="fl">0.5</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb11-6"><a href="week-5.html#cb11-6" aria-hidden="true" tabindex="-1"></a>                               <span class="dv">0</span>, <span class="fl">0.3</span>, <span class="dv">0</span>),</span>
<span id="cb11-7"><a href="week-5.html#cb11-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">nrow =</span> <span class="dv">3</span>, </span>
<span id="cb11-8"><a href="week-5.html#cb11-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb11-9"><a href="week-5.html#cb11-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">byrow =</span> T)</span>
<span id="cb11-10"><a href="week-5.html#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="week-5.html#cb11-11" aria-hidden="true" tabindex="-1"></a>initial_age <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb11-12"><a href="week-5.html#cb11-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-13"><a href="week-5.html#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="do">### for loop and matrix algebra</span></span>
<span id="cb11-14"><a href="week-5.html#cb11-14" aria-hidden="true" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb11-15"><a href="week-5.html#cb11-15" aria-hidden="true" tabindex="-1"></a>pop_size <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Age1 =</span> <span class="fu">numeric</span>(time<span class="sc">+</span><span class="dv">1</span>),</span>
<span id="cb11-16"><a href="week-5.html#cb11-16" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Age2 =</span> <span class="fu">numeric</span>(time<span class="sc">+</span><span class="dv">1</span>),</span>
<span id="cb11-17"><a href="week-5.html#cb11-17" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Age3 =</span> <span class="fu">numeric</span>(time<span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb11-18"><a href="week-5.html#cb11-18" aria-hidden="true" tabindex="-1"></a>pop_size[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> initial_age</span>
<span id="cb11-19"><a href="week-5.html#cb11-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-20"><a href="week-5.html#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>time) {</span>
<span id="cb11-21"><a href="week-5.html#cb11-21" aria-hidden="true" tabindex="-1"></a>  pop_size[i<span class="sc">+</span><span class="dv">1</span>, ] <span class="ot">&lt;-</span> leslie_mtrx <span class="sc">%*%</span> <span class="fu">as.matrix</span>(<span class="fu">t</span>(pop_size[i, ]))</span>
<span id="cb11-22"><a href="week-5.html#cb11-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-23"><a href="week-5.html#cb11-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-24"><a href="week-5.html#cb11-24" aria-hidden="true" tabindex="-1"></a>pop_size <span class="ot">&lt;-</span> pop_size <span class="sc">%&gt;%</span> </span>
<span id="cb11-25"><a href="week-5.html#cb11-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>() <span class="sc">%&gt;%</span></span>
<span id="cb11-26"><a href="week-5.html#cb11-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Total_N =</span> <span class="fu">rowSums</span>(.), </span>
<span id="cb11-27"><a href="week-5.html#cb11-27" aria-hidden="true" tabindex="-1"></a>         <span class="at">Time =</span> <span class="dv">0</span><span class="sc">:</span>time) <span class="sc">%&gt;%</span></span>
<span id="cb11-28"><a href="week-5.html#cb11-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Time)</span>
<span id="cb11-29"><a href="week-5.html#cb11-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-30"><a href="week-5.html#cb11-30" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">round</span>(pop_size)) </span></code></pre></div>
<pre><code>##   Time Age1 Age2 Age3 Total_N
## 1    0   10    0    0      10
## 2    1    0    5    0       5
## 3    2    5    0    2       7
## 4    3    8    2    0      10
## 5    4    2    4    1       7
## 6    5    8    1    1      10</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="week-5.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Asymptotic growth rate and stable age distribution </span></span>
<span id="cb13-2"><a href="week-5.html#cb13-2" aria-hidden="true" tabindex="-1"></a>asymptotic_growth <span class="ot">&lt;-</span> <span class="fu">round</span>(pop_size[time<span class="sc">+</span><span class="dv">1</span>, <span class="dv">5</span>]<span class="sc">/</span>pop_size[time, <span class="dv">5</span>], <span class="dv">3</span>)</span>
<span id="cb13-3"><a href="week-5.html#cb13-3" aria-hidden="true" tabindex="-1"></a>asymptotic_growth</span></code></pre></div>
<pre><code>## [1] 1.091</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="week-5.html#cb15-1" aria-hidden="true" tabindex="-1"></a>age_distribution <span class="ot">&lt;-</span> <span class="fu">round</span>(pop_size[time<span class="sc">+</span><span class="dv">1</span>, <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]<span class="sc">/</span><span class="fu">sum</span>(pop_size[time<span class="sc">+</span><span class="dv">1</span>, <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]), <span class="dv">3</span>)</span>
<span id="cb15-2"><a href="week-5.html#cb15-2" aria-hidden="true" tabindex="-1"></a>age_distribution</span></code></pre></div>
<pre><code>##     Age1  Age2  Age3
## 51 0.632 0.289 0.079</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="week-5.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Eigenanalysis of the Leslie matrix</span></span>
<span id="cb17-2"><a href="week-5.html#cb17-2" aria-hidden="true" tabindex="-1"></a>eigen_out <span class="ot">&lt;-</span> <span class="fu">eigen</span>(leslie_mtrx)</span>
<span id="cb17-3"><a href="week-5.html#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(eigen_out<span class="sc">$</span>values[<span class="dv">1</span>]) <span class="sc">%&gt;%</span> <span class="fu">round</span>(., <span class="dv">3</span>)  <span class="co"># dominant eigenvalue</span></span></code></pre></div>
<pre><code>## [1] 1.09</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="week-5.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(eigen_out<span class="sc">$</span>vectors[, <span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(eigen_out<span class="sc">$</span>vectors[, <span class="dv">1</span>])) <span class="sc">%&gt;%</span> </span>
<span id="cb19-2"><a href="week-5.html#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(., <span class="dv">3</span>)  <span class="co"># stable age distribution</span></span></code></pre></div>
<pre><code>## [1] 0.631 0.289 0.080</code></pre>
<p>The asymptotic growth rate and stable age distribution obtained from for loops and eigenanalysis are pretty much the same.</p>
<p><br></p>
<p><strong>Part 2 - Visualizing population dynamics and age distribution</strong></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="week-5.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Population sizes for each age class</span></span>
<span id="cb21-2"><a href="week-5.html#cb21-2" aria-hidden="true" tabindex="-1"></a>pop_size <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="week-5.html#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>Time, <span class="at">names_to =</span> <span class="st">&quot;Age_class&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;N&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-4"><a href="week-5.html#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> N, <span class="at">color =</span> Age_class)) <span class="sc">+</span> </span>
<span id="cb21-5"><a href="week-5.html#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb21-6"><a href="week-5.html#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb21-7"><a href="week-5.html#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;time&quot;</span>, <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">italic</span>(N))) <span class="sc">+</span></span>
<span id="cb21-8"><a href="week-5.html#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb21-9"><a href="week-5.html#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, time<span class="sc">*</span><span class="fl">1.05</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb21-10"><a href="week-5.html#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fu">max</span>(pop_size<span class="sc">$</span>Total_N)<span class="sc">*</span><span class="fl">1.05</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span> </span>
<span id="cb21-11"><a href="week-5.html#cb21-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#E41A1C&quot;</span>, <span class="st">&quot;#377EB8&quot;</span>, <span class="st">&quot;#4DAF4A&quot;</span>, <span class="st">&quot;black&quot;</span>),</span>
<span id="cb21-12"><a href="week-5.html#cb21-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="cn">NULL</span>,</span>
<span id="cb21-13"><a href="week-5.html#cb21-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;Age1&quot;</span>, <span class="st">&quot;Age2&quot;</span>, <span class="st">&quot;Age3&quot;</span>, <span class="st">&quot;Total&quot;</span>))</span></code></pre></div>
<p><img src="05_Week_5_files/figure-html/unnamed-chunk-2-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="week-5.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Stable age distribution</span></span>
<span id="cb22-2"><a href="week-5.html#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gganimate)</span>
<span id="cb22-3"><a href="week-5.html#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="week-5.html#cb22-4" aria-hidden="true" tabindex="-1"></a>age_animate <span class="ot">&lt;-</span> pop_size <span class="sc">%&gt;%</span> </span>
<span id="cb22-5"><a href="week-5.html#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(Age1<span class="sc">:</span>Age3, <span class="cf">function</span>(x){x<span class="sc">/</span>Total_N})) <span class="sc">%&gt;%</span></span>
<span id="cb22-6"><a href="week-5.html#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Time, Age1<span class="sc">:</span>Age3) <span class="sc">%&gt;%</span></span>
<span id="cb22-7"><a href="week-5.html#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(Age1<span class="sc">:</span>Age3, <span class="at">names_to =</span> <span class="st">&quot;Age&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;Proportion&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-8"><a href="week-5.html#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Age, <span class="at">y =</span> Proportion, <span class="at">fill =</span> Age)) <span class="sc">+</span> </span>
<span id="cb22-9"><a href="week-5.html#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb22-10"><a href="week-5.html#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb22-11"><a href="week-5.html#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb22-12"><a href="week-5.html#cb22-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set1&quot;</span>) <span class="sc">+</span> </span>
<span id="cb22-13"><a href="week-5.html#cb22-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span> </span>
<span id="cb22-14"><a href="week-5.html#cb22-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transition_manual</span>(Time) <span class="sc">+</span> </span>
<span id="cb22-15"><a href="week-5.html#cb22-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Time {frame}&quot;</span>) <span class="sc">+</span> </span>
<span id="cb22-16"><a href="week-5.html#cb22-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>))</span>
<span id="cb22-17"><a href="week-5.html#cb22-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-18"><a href="week-5.html#cb22-18" aria-hidden="true" tabindex="-1"></a><span class="fu">anim_save</span>(<span class="st">&quot;age_distribution.gif&quot;</span>, age_animate, <span class="at">nframes =</span> time <span class="sc">+</span> <span class="dv">1</span>, <span class="at">fps =</span> <span class="dv">4</span>, <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">units =</span> <span class="st">&quot;in&quot;</span>, <span class="at">res =</span> <span class="dv">300</span>)</span></code></pre></div>
<style>
.center {
  display: block;
  margin-left: auto;
  margin-right: auto;
  width: 70%;
}
</style>
<p><img src="age_distribution.gif" class="center"/></p>
<p><br></p>
<p><strong>Part 3 - In-class exercise: Analyzing population matrix of common teasel</strong></p>
<p><a href="https://en.wikipedia.org/wiki/Dipsacus_fullonum">Common teasel (<em>Dipsacus sylvestris</em>)</a> is a herbaceous plant commonly found in abandoned fields and meadows in North America. It has a complex life cycle consisting of various stages. The seeds may lie dormant for one or two years. Seeds that germinate form small rosettes, which will gradually transit into medium and eventually large rosettes. These rosettes (all three sizes) may remain in the same stage for years before entering the next stage. After undergoing vernalization, large (and a few medium) rosettes will form stalks and flower in the upcoming summer, set seeds once, and die. Occasionally, the flowering plants will produce seeds that directly germinate into small/medium/large rosettes without entering dormancy.</p>
<p>Here is a transition diagram for the teasel. Please convert this diagram into a stage-based transition matrix (Lefkovitch matrix) and derive the asymptotic growth rate <span class="math inline">\(\lambda\)</span> in R.</p>
<p><img src="Teasel%20Diagram.png" width= "100%"/></p>
<p><br></p>
<p><strong>Part 4 - Advanced topic: Incorporating density-dependence into Leslie matrix </strong></p>
<p>The cell values in a standard Leslie matrix are fixed and independent of population density, leading to an exponential population growth. This assumption can be relaxed by incorporating density-dependence into the transitions (survival probability, fecundity). Here, we will include negative density-dependence for the fecundity of individuals in Age3 class and see how this might affect the long-term population dynamics.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="week-5.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Leslie matrix, initial age classes, and carrying capacity</span></span>
<span id="cb23-2"><a href="week-5.html#cb23-2" aria-hidden="true" tabindex="-1"></a>leslie_mtrx <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">5</span>,</span>
<span id="cb23-3"><a href="week-5.html#cb23-3" aria-hidden="true" tabindex="-1"></a>                               <span class="fl">0.5</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb23-4"><a href="week-5.html#cb23-4" aria-hidden="true" tabindex="-1"></a>                               <span class="dv">0</span>, <span class="fl">0.3</span>, <span class="dv">0</span>),</span>
<span id="cb23-5"><a href="week-5.html#cb23-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">nrow =</span> <span class="dv">3</span>, </span>
<span id="cb23-6"><a href="week-5.html#cb23-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb23-7"><a href="week-5.html#cb23-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">byrow =</span> T)</span>
<span id="cb23-8"><a href="week-5.html#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="week-5.html#cb23-9" aria-hidden="true" tabindex="-1"></a>initial_age <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb23-10"><a href="week-5.html#cb23-10" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">300</span></span>
<span id="cb23-11"><a href="week-5.html#cb23-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-12"><a href="week-5.html#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="do">### for loop and matrix algebra</span></span>
<span id="cb23-13"><a href="week-5.html#cb23-13" aria-hidden="true" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="dv">150</span></span>
<span id="cb23-14"><a href="week-5.html#cb23-14" aria-hidden="true" tabindex="-1"></a>pop_size_dens_dep <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Age1 =</span> <span class="fu">numeric</span>(time<span class="sc">+</span><span class="dv">1</span>),</span>
<span id="cb23-15"><a href="week-5.html#cb23-15" aria-hidden="true" tabindex="-1"></a>                                <span class="at">Age2 =</span> <span class="fu">numeric</span>(time<span class="sc">+</span><span class="dv">1</span>),</span>
<span id="cb23-16"><a href="week-5.html#cb23-16" aria-hidden="true" tabindex="-1"></a>                                <span class="at">Age3 =</span> <span class="fu">numeric</span>(time<span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb23-17"><a href="week-5.html#cb23-17" aria-hidden="true" tabindex="-1"></a>pop_size_dens_dep[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> initial_age</span>
<span id="cb23-18"><a href="week-5.html#cb23-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-19"><a href="week-5.html#cb23-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>time) {</span>
<span id="cb23-20"><a href="week-5.html#cb23-20" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="fu">sum</span>(pop_size_dens_dep[i, ])  <span class="co"># the current population size</span></span>
<span id="cb23-21"><a href="week-5.html#cb23-21" aria-hidden="true" tabindex="-1"></a>  leslie_mtrx_dens_dep <span class="ot">&lt;-</span> leslie_mtrx</span>
<span id="cb23-22"><a href="week-5.html#cb23-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-23"><a href="week-5.html#cb23-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># negative density-dependence for the fecundity of individuals in Age3 class</span></span>
<span id="cb23-24"><a href="week-5.html#cb23-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ifelse</span>((<span class="dv">1</span><span class="sc">-</span>N<span class="sc">/</span>K) <span class="sc">&gt;</span> <span class="dv">0</span>,  </span>
<span id="cb23-25"><a href="week-5.html#cb23-25" aria-hidden="true" tabindex="-1"></a>         leslie_mtrx_dens_dep[<span class="dv">1</span>, <span class="dv">3</span>] <span class="ot">&lt;-</span> leslie_mtrx_dens_dep[<span class="dv">1</span>, <span class="dv">3</span>]<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>N<span class="sc">/</span>K),</span>
<span id="cb23-26"><a href="week-5.html#cb23-26" aria-hidden="true" tabindex="-1"></a>         leslie_mtrx_dens_dep[<span class="dv">1</span>, <span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="dv">0</span>)   </span>
<span id="cb23-27"><a href="week-5.html#cb23-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-28"><a href="week-5.html#cb23-28" aria-hidden="true" tabindex="-1"></a>  pop_size_dens_dep[i<span class="sc">+</span><span class="dv">1</span>, ] <span class="ot">&lt;-</span> leslie_mtrx_dens_dep <span class="sc">%*%</span> <span class="fu">as.matrix</span>(<span class="fu">t</span>(pop_size_dens_dep[i, ]))</span>
<span id="cb23-29"><a href="week-5.html#cb23-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-30"><a href="week-5.html#cb23-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-31"><a href="week-5.html#cb23-31" aria-hidden="true" tabindex="-1"></a>pop_size_dens_dep <span class="ot">&lt;-</span> pop_size_dens_dep <span class="sc">%&gt;%</span> </span>
<span id="cb23-32"><a href="week-5.html#cb23-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>() <span class="sc">%&gt;%</span></span>
<span id="cb23-33"><a href="week-5.html#cb23-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Total_N =</span> <span class="fu">rowSums</span>(.), </span>
<span id="cb23-34"><a href="week-5.html#cb23-34" aria-hidden="true" tabindex="-1"></a>         <span class="at">Time =</span> <span class="dv">0</span><span class="sc">:</span>time) <span class="sc">%&gt;%</span></span>
<span id="cb23-35"><a href="week-5.html#cb23-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Time)</span>
<span id="cb23-36"><a href="week-5.html#cb23-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-37"><a href="week-5.html#cb23-37" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">round</span>(pop_size_dens_dep)) </span></code></pre></div>
<pre><code>##   Time Age1 Age2 Age3 Total_N
## 1    0   10    0    0      10
## 2    1    0    5    0       5
## 3    2    5    0    2       7
## 4    3    7    2    0       9
## 5    4    2    4    1       7
## 6    5    7    1    1       9</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="week-5.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Age distribution</span></span>
<span id="cb25-2"><a href="week-5.html#cb25-2" aria-hidden="true" tabindex="-1"></a>age_distribution_dens_dep <span class="ot">&lt;-</span> <span class="fu">round</span>(pop_size_dens_dep[time<span class="sc">+</span><span class="dv">1</span>, <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]<span class="sc">/</span><span class="fu">sum</span>(pop_size_dens_dep[time<span class="sc">+</span><span class="dv">1</span>, <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]), <span class="dv">3</span>)</span>
<span id="cb25-3"><a href="week-5.html#cb25-3" aria-hidden="true" tabindex="-1"></a>age_distribution_dens_dep</span></code></pre></div>
<pre><code>##     Age1 Age2 Age3
## 151 0.61  0.3 0.09</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="week-5.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Total population size</span></span>
<span id="cb27-2"><a href="week-5.html#cb27-2" aria-hidden="true" tabindex="-1"></a>pop_size_dens_dep <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="week-5.html#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>Time, <span class="at">names_to =</span> <span class="st">&quot;Age_class&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;N&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-4"><a href="week-5.html#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> N, <span class="at">color =</span> Age_class)) <span class="sc">+</span> </span>
<span id="cb27-5"><a href="week-5.html#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb27-6"><a href="week-5.html#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb27-7"><a href="week-5.html#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;time&quot;</span>, <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">italic</span>(N))) <span class="sc">+</span></span>
<span id="cb27-8"><a href="week-5.html#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb27-9"><a href="week-5.html#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, time<span class="sc">*</span><span class="fl">1.05</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb27-10"><a href="week-5.html#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(pop_size_dens_dep<span class="sc">$</span>Total_N)<span class="sc">*</span><span class="fl">1.05</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span> </span>
<span id="cb27-11"><a href="week-5.html#cb27-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#E41A1C&quot;</span>, <span class="st">&quot;#377EB8&quot;</span>, <span class="st">&quot;#4DAF4A&quot;</span>, <span class="st">&quot;black&quot;</span>),</span>
<span id="cb27-12"><a href="week-5.html#cb27-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="cn">NULL</span>,</span>
<span id="cb27-13"><a href="week-5.html#cb27-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;Age1&quot;</span>, <span class="st">&quot;Age2&quot;</span>, <span class="st">&quot;Age3&quot;</span>, <span class="st">&quot;Total&quot;</span>))</span></code></pre></div>
<p><img src="05_Week_5_files/figure-html/unnamed-chunk-3-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="week-5.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Stable age distribution</span></span>
<span id="cb28-2"><a href="week-5.html#cb28-2" aria-hidden="true" tabindex="-1"></a>age_animate_dens_dep <span class="ot">&lt;-</span> pop_size_dens_dep <span class="sc">%&gt;%</span> </span>
<span id="cb28-3"><a href="week-5.html#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(Age1<span class="sc">:</span>Age3, <span class="cf">function</span>(x){x<span class="sc">/</span>Total_N})) <span class="sc">%&gt;%</span></span>
<span id="cb28-4"><a href="week-5.html#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Time, Age1<span class="sc">:</span>Age3) <span class="sc">%&gt;%</span></span>
<span id="cb28-5"><a href="week-5.html#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(Age1<span class="sc">:</span>Age3, <span class="at">names_to =</span> <span class="st">&quot;Age&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;Proportion&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-6"><a href="week-5.html#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Age, <span class="at">y =</span> Proportion, <span class="at">fill =</span> Age)) <span class="sc">+</span> </span>
<span id="cb28-7"><a href="week-5.html#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb28-8"><a href="week-5.html#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb28-9"><a href="week-5.html#cb28-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb28-10"><a href="week-5.html#cb28-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set1&quot;</span>) <span class="sc">+</span> </span>
<span id="cb28-11"><a href="week-5.html#cb28-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span> </span>
<span id="cb28-12"><a href="week-5.html#cb28-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transition_manual</span>(Time) <span class="sc">+</span> </span>
<span id="cb28-13"><a href="week-5.html#cb28-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Time {frame}&quot;</span>) <span class="sc">+</span> </span>
<span id="cb28-14"><a href="week-5.html#cb28-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>))</span>
<span id="cb28-15"><a href="week-5.html#cb28-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-16"><a href="week-5.html#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="fu">anim_save</span>(<span class="st">&quot;age_distribution_dens_dep.gif&quot;</span>, age_animate_dens_dep, <span class="at">nframes =</span> time <span class="sc">+</span> <span class="dv">1</span>, <span class="at">fps =</span> <span class="dv">4</span>, <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">units =</span> <span class="st">&quot;in&quot;</span>, <span class="at">res =</span> <span class="dv">300</span>)</span></code></pre></div>
<p><img src="age_distribution_dens_dep.gif" class="center"/></p>
<p><br></p>
<p><strong>Part 5 - COM(P)ADRE: A global database of population matrices</strong></p>
<p><a href="https://compadre-db.org/ExploreDatabase">COM(P)ADRE</a> is an online repository containing matrix population models on hundreds of plants, animals, algae, fungi, bacteria, and viruses around the world, as well as their associated metadata. Take a look at the website: You will be exploring the population dynamics of a species (of your choice) in your assignment!</p>
<p><br></p>
</div>
<div id="additional-readings-4" class="section level2 unnumbered">
<h2>Additional readings</h2>
<p><a href="./Additional%20readings/Otto_&amp;_Day_Box_9-1.pdf" target="_blank">Otto &amp; Day Box 9.1 - Long-Term Dynamics and the Role of the Leading Eigenvalue</a>
<br></p>
</div>
<div id="assignments-4" class="section level2 unnumbered">
<h2>Assignments</h2>
<p><a href="./Assignments/Week5_Age-Structured%20Models.pdf" target="_blank">Age-Structured Models</a></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="week-4.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="week-6.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"info": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
