<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Week 12 | Introduction to Theoretical Ecology</title>
  <meta name="description" content="This is the course website for Introduction to Theoretical Ecology 2021 Fall at National Taiwan University." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Week 12 | Introduction to Theoretical Ecology" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://genchanghsu.github.io/2021_Fall_Introduction_to_Theoretical_Ecology/" />
  <meta property="og:image" content="https://genchanghsu.github.io/2021_Fall_Introduction_to_Theoretical_Ecology/bifurcation.gif" />
  <meta property="og:description" content="This is the course website for Introduction to Theoretical Ecology 2021 Fall at National Taiwan University." />
  <meta name="github-repo" content="GenChangHSU/2021_Fall_Introduction_to_Theoretical_Ecology" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Week 12 | Introduction to Theoretical Ecology" />
  
  <meta name="twitter:description" content="This is the course website for Introduction to Theoretical Ecology 2021 Fall at National Taiwan University." />
  <meta name="twitter:image" content="https://genchanghsu.github.io/2021_Fall_Introduction_to_Theoretical_Ecology/bifurcation.gif" />

<meta name="author" content="Instructor: Po-Ju Ke ~~~~~ Teaching Assistant: Gen-Chang Hsu" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="week-11.html"/>
<link rel="next" href="week-13.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introduction to Theoretical Ecology</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Course Information</a></li>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html"><i class="fa fa-check"></i>Syllabus</a></li>
<li class="chapter" data-level="" data-path="week-1.html"><a href="week-1.html"><i class="fa fa-check"></i>Week 1</a>
<ul>
<li class="chapter" data-level="" data-path="week-1.html"><a href="week-1.html#lecture-in-a-nutshell"><i class="fa fa-check"></i>Lecture in a nutshell</a></li>
<li class="chapter" data-level="" data-path="week-1.html"><a href="week-1.html#lab-demonstration"><i class="fa fa-check"></i>Lab demonstration</a></li>
<li class="chapter" data-level="" data-path="week-1.html"><a href="week-1.html#additional-readings"><i class="fa fa-check"></i>Additional readings</a></li>
<li class="chapter" data-level="" data-path="week-1.html"><a href="week-1.html#assignments"><i class="fa fa-check"></i>Assignments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-2.html"><a href="week-2.html"><i class="fa fa-check"></i>Week 2</a>
<ul>
<li class="chapter" data-level="" data-path="week-2.html"><a href="week-2.html#lecture-in-a-nutshell-1"><i class="fa fa-check"></i>Lecture in a nutshell</a></li>
<li class="chapter" data-level="" data-path="week-2.html"><a href="week-2.html#lab-demonstration-1"><i class="fa fa-check"></i>Lab demonstration</a></li>
<li class="chapter" data-level="" data-path="week-2.html"><a href="week-2.html#additional-readings-1"><i class="fa fa-check"></i>Additional readings</a></li>
<li class="chapter" data-level="" data-path="week-2.html"><a href="week-2.html#assignments-1"><i class="fa fa-check"></i>Assignments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-3.html"><a href="week-3.html"><i class="fa fa-check"></i>Week 3</a>
<ul>
<li class="chapter" data-level="" data-path="week-3.html"><a href="week-3.html#lecture-in-a-nutshell-2"><i class="fa fa-check"></i>Lecture in a nutshell</a></li>
<li class="chapter" data-level="" data-path="week-3.html"><a href="week-3.html#lab-demonstration-2"><i class="fa fa-check"></i>Lab demonstration</a></li>
<li class="chapter" data-level="" data-path="week-3.html"><a href="week-3.html#additional-readings-2"><i class="fa fa-check"></i>Additional readings</a></li>
<li class="chapter" data-level="" data-path="week-3.html"><a href="week-3.html#assignments-2"><i class="fa fa-check"></i>Assignments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-4.html"><a href="week-4.html"><i class="fa fa-check"></i>Week 4</a>
<ul>
<li class="chapter" data-level="" data-path="week-4.html"><a href="week-4.html#lecture-in-a-nutshell-3"><i class="fa fa-check"></i>Lecture in a nutshell</a></li>
<li class="chapter" data-level="" data-path="week-4.html"><a href="week-4.html#lab-demonstration-3"><i class="fa fa-check"></i>Lab demonstration</a></li>
<li class="chapter" data-level="" data-path="week-4.html"><a href="week-4.html#additional-readings-3"><i class="fa fa-check"></i>Additional readings</a></li>
<li class="chapter" data-level="" data-path="week-4.html"><a href="week-4.html#assignments-3"><i class="fa fa-check"></i>Assignments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-5.html"><a href="week-5.html"><i class="fa fa-check"></i>Week 5</a>
<ul>
<li class="chapter" data-level="" data-path="week-5.html"><a href="week-5.html#lecture-in-a-nutshell-4"><i class="fa fa-check"></i>Lecture in a nutshell</a></li>
<li class="chapter" data-level="" data-path="week-5.html"><a href="week-5.html#lab-demonstration-4"><i class="fa fa-check"></i>Lab demonstration</a></li>
<li class="chapter" data-level="" data-path="week-5.html"><a href="week-5.html#additional-readings-4"><i class="fa fa-check"></i>Additional readings</a></li>
<li class="chapter" data-level="" data-path="week-5.html"><a href="week-5.html#assignments-4"><i class="fa fa-check"></i>Assignments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-6.html"><a href="week-6.html"><i class="fa fa-check"></i>Week 6</a>
<ul>
<li class="chapter" data-level="" data-path="week-6.html"><a href="week-6.html#lecture-in-a-nutshell-5"><i class="fa fa-check"></i>Lecture in a nutshell</a></li>
<li class="chapter" data-level="" data-path="week-6.html"><a href="week-6.html#lab-demonstration-5"><i class="fa fa-check"></i>Lab demonstration</a></li>
<li class="chapter" data-level="" data-path="week-6.html"><a href="week-6.html#additional-readings-5"><i class="fa fa-check"></i>Additional readings</a></li>
<li class="chapter" data-level="" data-path="week-6.html"><a href="week-6.html#assignments-5"><i class="fa fa-check"></i>Assignments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-7.html"><a href="week-7.html"><i class="fa fa-check"></i>Week 7</a>
<ul>
<li class="chapter" data-level="" data-path="week-7.html"><a href="week-7.html#lecture-in-a-nutshell-6"><i class="fa fa-check"></i>Lecture in a nutshell</a></li>
<li class="chapter" data-level="" data-path="week-7.html"><a href="week-7.html#lab-demonstration-6"><i class="fa fa-check"></i>Lab demonstration</a></li>
<li class="chapter" data-level="" data-path="week-7.html"><a href="week-7.html#additional-readings-6"><i class="fa fa-check"></i>Additional readings</a></li>
<li class="chapter" data-level="" data-path="week-7.html"><a href="week-7.html#assignments-6"><i class="fa fa-check"></i>Assignments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-8.html"><a href="week-8.html"><i class="fa fa-check"></i>Week 8</a>
<ul>
<li class="chapter" data-level="" data-path="week-8.html"><a href="week-8.html#lecture-in-a-nutshell-7"><i class="fa fa-check"></i>Lecture in a nutshell</a></li>
<li class="chapter" data-level="" data-path="week-8.html"><a href="week-8.html#lab-demonstration-7"><i class="fa fa-check"></i>Lab demonstration</a></li>
<li class="chapter" data-level="" data-path="week-8.html"><a href="week-8.html#additional-readings-7"><i class="fa fa-check"></i>Additional readings</a></li>
<li class="chapter" data-level="" data-path="week-8.html"><a href="week-8.html#assignments-7"><i class="fa fa-check"></i>Assignments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-9.html"><a href="week-9.html"><i class="fa fa-check"></i>Week 9</a></li>
<li class="chapter" data-level="" data-path="week-10.html"><a href="week-10.html"><i class="fa fa-check"></i>Week 10</a>
<ul>
<li class="chapter" data-level="" data-path="week-10.html"><a href="week-10.html#lecture-in-a-nutshell-8"><i class="fa fa-check"></i>Lecture in a nutshell</a></li>
<li class="chapter" data-level="" data-path="week-10.html"><a href="week-10.html#lab-demonstration-8"><i class="fa fa-check"></i>Lab demonstration</a></li>
<li class="chapter" data-level="" data-path="week-10.html"><a href="week-10.html#additional-readings-8"><i class="fa fa-check"></i>Additional readings</a></li>
<li class="chapter" data-level="" data-path="week-10.html"><a href="week-10.html#assignments-8"><i class="fa fa-check"></i>Assignments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-11.html"><a href="week-11.html"><i class="fa fa-check"></i>Week 11</a>
<ul>
<li class="chapter" data-level="" data-path="week-11.html"><a href="week-11.html#lecture-in-a-nutshell-9"><i class="fa fa-check"></i>Lecture in a nutshell</a></li>
<li class="chapter" data-level="" data-path="week-11.html"><a href="week-11.html#lab-demonstration-9"><i class="fa fa-check"></i>Lab demonstration</a>
<ul>
<li class="chapter" data-level="" data-path="week-11.html"><a href="week-11.html#special-topic-time-scale-separation"><i class="fa fa-check"></i>Special topic: time-scale separation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-11.html"><a href="week-11.html#additional-readings-9"><i class="fa fa-check"></i>Additional readings</a></li>
<li class="chapter" data-level="" data-path="week-11.html"><a href="week-11.html#assignments-9"><i class="fa fa-check"></i>Assignments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-12.html"><a href="week-12.html"><i class="fa fa-check"></i>Week 12</a>
<ul>
<li class="chapter" data-level="" data-path="week-12.html"><a href="week-12.html#lecture-in-a-nutshell-10"><i class="fa fa-check"></i>Lecture in a nutshell</a></li>
<li class="chapter" data-level="" data-path="week-12.html"><a href="week-12.html#lab-demonstration-10"><i class="fa fa-check"></i>Lab demonstration</a>
<ul>
<li class="chapter" data-level="" data-path="week-12.html"><a href="week-12.html#part-1---r-rule"><i class="fa fa-check"></i>Part 1 - R* rule</a></li>
<li class="chapter" data-level="" data-path="week-12.html"><a href="week-12.html#part-2---tilmans-resource-ratio-hypothesis"><i class="fa fa-check"></i>Part 2 - Tilman’s resource ratio hypothesis</a></li>
<li class="chapter" data-level="" data-path="week-12.html"><a href="week-12.html#part-3---relative-nonlinearity"><i class="fa fa-check"></i>Part 3 - Relative nonlinearity</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-12.html"><a href="week-12.html#additional-readings-10"><i class="fa fa-check"></i>Additional readings</a></li>
<li class="chapter" data-level="" data-path="week-12.html"><a href="week-12.html#assignments-10"><i class="fa fa-check"></i>Assignments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-13.html"><a href="week-13.html"><i class="fa fa-check"></i>Week 13</a>
<ul>
<li class="chapter" data-level="" data-path="week-13.html"><a href="week-13.html#lecture-in-a-nutshell-11"><i class="fa fa-check"></i>Lecture in a nutshell</a></li>
<li class="chapter" data-level="" data-path="week-13.html"><a href="week-13.html#lab-demonstration-11"><i class="fa fa-check"></i>Lab demonstration</a></li>
<li class="chapter" data-level="" data-path="week-13.html"><a href="week-13.html#additional-readings-11"><i class="fa fa-check"></i>Additional readings</a></li>
<li class="chapter" data-level="" data-path="week-13.html"><a href="week-13.html#assignments-11"><i class="fa fa-check"></i>Assignments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-14.html"><a href="week-14.html"><i class="fa fa-check"></i>Week 14</a>
<ul>
<li class="chapter" data-level="" data-path="week-14.html"><a href="week-14.html#lecture-in-a-nutshell-12"><i class="fa fa-check"></i>Lecture in a nutshell</a></li>
<li class="chapter" data-level="" data-path="week-14.html"><a href="week-14.html#lab-demonstration-12"><i class="fa fa-check"></i>Lab demonstration</a></li>
<li class="chapter" data-level="" data-path="week-14.html"><a href="week-14.html#additional-readings-12"><i class="fa fa-check"></i>Additional readings</a></li>
<li class="chapter" data-level="" data-path="week-14.html"><a href="week-14.html#assignments-12"><i class="fa fa-check"></i>Assignments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-15.html"><a href="week-15.html"><i class="fa fa-check"></i>Week 15</a>
<ul>
<li class="chapter" data-level="" data-path="week-15.html"><a href="week-15.html#lecture-review"><i class="fa fa-check"></i>Lecture review</a></li>
<li class="chapter" data-level="" data-path="week-15.html"><a href="week-15.html#lab-review"><i class="fa fa-check"></i>Lab review</a>
<ul>
<li class="chapter" data-level="" data-path="week-15.html"><a href="week-15.html#desolve-and-numerical-integration"><i class="fa fa-check"></i>1. deSolve and numerical integration</a></li>
<li class="chapter" data-level="" data-path="week-15.html"><a href="week-15.html#for-loops"><i class="fa fa-check"></i>2. for loops</a></li>
<li class="chapter" data-level="" data-path="week-15.html"><a href="week-15.html#matrix-multiplication-and-eigenanalysis"><i class="fa fa-check"></i>3. Matrix multiplication and eigenanalysis</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-15.html"><a href="week-15.html#additional-readings-13"><i class="fa fa-check"></i>Additional readings</a></li>
<li class="chapter" data-level="" data-path="week-15.html"><a href="week-15.html#assignments-13"><i class="fa fa-check"></i>Assignments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-16.html"><a href="week-16.html"><i class="fa fa-check"></i>Week 16</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Site built with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Theoretical Ecology</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="week-12" class="section level1 unnumbered">
<h1>Week 12</h1>
<div style="font-size: 28pt">
<strong><em>Resource competition: R* models</em></strong>
</div>
<div id="lecture-in-a-nutshell-10" class="section level2 unnumbered">
<h2>Lecture in a nutshell</h2>
<ul>
<li><strong>Exploitative competition (consumer-resource dynamics)</strong>
<ol style="list-style-type: decimal">
<li>R* rule:
<ul>
<li>2 consumers + 1 resource
<div style="margin-left: 15%; margin-top: 15px;">
<span class="math inline">\(\begin{align}\frac {dN_{1}}{dt} = e_{1}a_{1}RN_{1}-dN_{1}\end{align}\\\)</span>
</div>
<div style="margin-left: 15%;">
<span class="math inline">\(\begin{align}\frac {dN_{2}}{dt} = e_{2}a_{2}RN_{2}-dN_{2}\end{align}\\\)</span>
</div>
<div style="margin-left: 15%; margin-bottom: 15px;">
<span class="math inline">\(\begin{align}\frac {dR}{dt} = d(S_{0}-R)-a_{1}RN_{1}-a_{2}RN_{2}\end{align}\)</span>
</div></li>
<li>The two consumers <strong>CANNOT</strong> coexist: the one with lower R* (the resource level at the monoculture equilibrium) will win</li>
<li>Generalization: When multiple species are competing for a single resource, coexistence is not possible. The species with the lowest R* will win at equilibrium.</li>
</ul></li>
<li>Tilman’s resource ratio hypothesis:
<ul>
<li>2 consumers + 2 resources
<div style="margin-left: 15%; margin-top: 15px;">
<span class="math inline">\(\begin{align}\frac {dN_{1}}{dt} = e_{1}a_{1a}R_{a}N_{1}+e_{1}a_{1b}R_{b}N_{1}-dN_{1}\end{align}\\\)</span>
</div>
<div style="margin-left: 15%;">
<span class="math inline">\(\begin{align}\frac {dN_{2}}{dt} = e_{2}a_{2a}R_{a}N_{2}+e_{2}a_{2b}R_{b}N_{2}-dN_{2}\end{align}\\\)</span>
</div>
<div style="margin-left: 15%; margin-bottom: 15px;">
<span class="math inline">\(\begin{align}\frac {dR_{a}}{dt} = d(S_{a}-R_{a})-a_{1a}R_{a}N_{1}-a_{2a}R_{a}N_{2}\end{align}\)</span>
</div>
<div style="margin-left: 15%; margin-bottom: 15px;">
<span class="math inline">\(\begin{align}\frac {dR_{b}}{dt} = d(S_{b}-R_{b})-a_{1b}R_{b}N_{1}-a_{2b}R_{b}N_{2}\end{align}\)</span>
</div></li>
<li>Outcomes:
<ol style="list-style-type: decimal">
<li>Consumer 1 wins: <span class="math inline">\(ZNGI_{2}\)</span> lies above <span class="math inline">\(ZNGI_{1}\)</span> in the <span class="math inline">\(R_{a}\)</span>-<span class="math inline">\(R_{b}\)</span> state space</li>
<li>Consumer 2 wins: <span class="math inline">\(ZNGI_{1}\)</span> lies above <span class="math inline">\(ZNGI_{2}\)</span> in the <span class="math inline">\(R_{a}\)</span>-<span class="math inline">\(R_{b}\)</span> state space</li>
<li>Coexist: <span class="math inline">\(ZNGI_{1}\)</span> and <span class="math inline">\(ZNGI_{2}\)</span> cross (trade-off in competitiveness); species should consume more of the resource that limits its growth (i.e., the resource of which the decline leads to the largest reduction in growth); resource supply should be balanced</li>
<li>Priority effect</li>
</ol></li>
</ul></li>
<li>Armstrong &amp; McGehee relative nonlinearity
<ul>
<li>2 consumers + 1 resource
<div style="margin-left: 25%;">
<span class="math inline">\(\begin{align}\frac {dN_{1}}{dt} = e_{1}a_{1}RN_{1}-d_{1}N_{1}\end{align}\\\)</span>
</div>
<div style="margin-left: 25%;">
<span class="math inline">\(\begin{align}\frac {dN_{2}}{dt} = e_{2}\frac{a_{2}R}{k_{2}+R}N_{2}-d_{2}N_{2}\end{align}\\\)</span>
</div>
<div style="margin-left: 25%; margin-bottom: 15px;">
<span class="math inline">\(\begin{align}\frac {dR}{dt} = rR(1-\frac{R}{K})-a_{1}RN_{1}-\frac{a_{2}R}{k_{2}+R}N_{2}\end{align}\)</span>
</div></li>
<li>Logistically-growing resource + type-II functional response of one consumer</li>
<li>Fluctuating resource generates stable limit cycles (fluctuating-dependent coexistence): coexistence occurs if <span class="math inline">\(R^{**}\)</span> &lt; <span class="math inline">\(R^{*}\)</span> &lt; <span class="math inline">\(\bar{R}\)</span></li>
</ul></li>
</ol></li>
</ul>
<p><br></p>
</div>
<div id="lab-demonstration-10" class="section level2 unnumbered">
<h2>Lab demonstration</h2>
<div id="part-1---r-rule" class="section level3 unnumbered">
<h3>Part 1 - R* rule</h3>
<p>In this part of the lab section, we are going to analyze the consumer-resource dynamics with two consumers and one resource:</p>
<div style="margin-left: 30%;">
<span class="math inline">\(\begin{align}\frac {dN_{1}}{dt} = e_{1}a_{1}RN_{1}-dN_{1}\end{align}\\\)</span>
</div>
<div style="margin-left: 30%;">
<span class="math inline">\(\begin{align}\frac {dN_{2}}{dt} = e_{2}a_{2}RN_{2}-dN_{2}\end{align}\\\)</span>
</div>
<div style="margin-left: 30%; margin-bottom: 15px;">
<span class="math inline">\(\begin{align}\frac {dR}{dt} = d(S_{0}-R)-a_{1}RN_{1}-a_{2}RN_{2}\end{align}\)</span>
</div>
<p>Please simulate the model using the parameter set (<em>N<sub>1</sub></em> = 2, <em>N<sub>2</sub></em> = 2, <em>R</em> = 0.1, <em>a<sub>1</sub></em> = 0.4, <em>a<sub>2</sub></em> = 0.6, <em>e<sub>1</sub></em> = 1, <em>e<sub>2</sub></em> = 1, <em>d</em> = 0.01, <em>S<sub>0</sub></em> = 0.1) and visualize the population trajectories of the two consumers as well as the resource.</p>
<p>Below is a plot of resource level vs. consumers’ per capita growth rate. What would you predict about the system dynamics?</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="week-12.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb42-2"><a href="week-12.html#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(deSolve)</span>
<span id="cb42-3"><a href="week-12.html#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="week-12.html#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="do">### Parameters</span></span>
<span id="cb42-5"><a href="week-12.html#cb42-5" aria-hidden="true" tabindex="-1"></a>a1 <span class="ot">&lt;-</span> <span class="fl">0.4</span> </span>
<span id="cb42-6"><a href="week-12.html#cb42-6" aria-hidden="true" tabindex="-1"></a>a2 <span class="ot">&lt;-</span> <span class="fl">0.6</span></span>
<span id="cb42-7"><a href="week-12.html#cb42-7" aria-hidden="true" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb42-8"><a href="week-12.html#cb42-8" aria-hidden="true" tabindex="-1"></a>e2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb42-9"><a href="week-12.html#cb42-9" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fl">0.01</span> </span>
<span id="cb42-10"><a href="week-12.html#cb42-10" aria-hidden="true" tabindex="-1"></a>S0 <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb42-11"><a href="week-12.html#cb42-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-12"><a href="week-12.html#cb42-12" aria-hidden="true" tabindex="-1"></a><span class="do">### Resource level vs. consumers&#39; per capita population growth</span></span>
<span id="cb42-13"><a href="week-12.html#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">R =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">0.1</span>, <span class="fl">0.001</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-14"><a href="week-12.html#cb42-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">N1 =</span> e1<span class="sc">*</span>a1<span class="sc">*</span>R<span class="sc">-</span>d,</span>
<span id="cb42-15"><a href="week-12.html#cb42-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">N2 =</span> e2<span class="sc">*</span>a2<span class="sc">*</span>R<span class="sc">-</span>d) <span class="sc">%&gt;%</span></span>
<span id="cb42-16"><a href="week-12.html#cb42-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>R, <span class="at">names_to =</span> <span class="st">&quot;species&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;N&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-17"><a href="week-12.html#cb42-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> R, <span class="at">y =</span> N, <span class="at">color =</span> species)) <span class="sc">+</span></span>
<span id="cb42-18"><a href="week-12.html#cb42-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span> </span>
<span id="cb42-19"><a href="week-12.html#cb42-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span> </span>
<span id="cb42-20"><a href="week-12.html#cb42-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Resource level&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Per capita growth rate&quot;</span>) <span class="sc">+</span></span>
<span id="cb42-21"><a href="week-12.html#cb42-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.11</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb42-22"><a href="week-12.html#cb42-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="fl">0.05</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb42-23"><a href="week-12.html#cb42-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">name =</span> <span class="cn">NULL</span>, <span class="at">palette =</span> <span class="st">&quot;Set1&quot;</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb42-24"><a href="week-12.html#cb42-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">14</span>)</span></code></pre></div>
<p><img src="12_Week_12_files/figure-html/unnamed-chunk-1-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="week-12.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Model specification</span></span>
<span id="cb43-2"><a href="week-12.html#cb43-2" aria-hidden="true" tabindex="-1"></a>CR_model_2C_1R <span class="ot">&lt;-</span> <span class="cf">function</span>(times, state, parms){</span>
<span id="cb43-3"><a href="week-12.html#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">as.list</span>(<span class="fu">c</span>(state, parms)), {</span>
<span id="cb43-4"><a href="week-12.html#cb43-4" aria-hidden="true" tabindex="-1"></a>    dN1_dt <span class="ot">=</span> e1<span class="sc">*</span>a1<span class="sc">*</span>R<span class="sc">*</span>N1 <span class="sc">-</span> d<span class="sc">*</span>N1</span>
<span id="cb43-5"><a href="week-12.html#cb43-5" aria-hidden="true" tabindex="-1"></a>    dN2_dt <span class="ot">=</span> e2<span class="sc">*</span>a2<span class="sc">*</span>R<span class="sc">*</span>N2 <span class="sc">-</span> d<span class="sc">*</span>N2</span>
<span id="cb43-6"><a href="week-12.html#cb43-6" aria-hidden="true" tabindex="-1"></a>    dR_dt <span class="ot">=</span>  d<span class="sc">*</span>(S0<span class="sc">-</span>R) <span class="sc">-</span> a1<span class="sc">*</span>R<span class="sc">*</span>N1 <span class="sc">-</span> a2<span class="sc">*</span>R<span class="sc">*</span>N2</span>
<span id="cb43-7"><a href="week-12.html#cb43-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="fu">c</span>(dN1_dt, dN2_dt, dR_dt)))</span>
<span id="cb43-8"><a href="week-12.html#cb43-8" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb43-9"><a href="week-12.html#cb43-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-10"><a href="week-12.html#cb43-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-11"><a href="week-12.html#cb43-11" aria-hidden="true" tabindex="-1"></a><span class="do">### Model parameters</span></span>
<span id="cb43-12"><a href="week-12.html#cb43-12" aria-hidden="true" tabindex="-1"></a>times <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="dv">1000</span>, <span class="at">by =</span> <span class="fl">0.1</span>)  </span>
<span id="cb43-13"><a href="week-12.html#cb43-13" aria-hidden="true" tabindex="-1"></a>state <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">N1 =</span> <span class="dv">2</span>, <span class="at">N2 =</span> <span class="dv">2</span>, <span class="at">R =</span> <span class="fl">0.1</span>)  </span>
<span id="cb43-14"><a href="week-12.html#cb43-14" aria-hidden="true" tabindex="-1"></a>parms <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">a1 =</span> <span class="fl">0.4</span>, <span class="at">a2 =</span> <span class="fl">0.6</span>, <span class="at">e1 =</span> <span class="dv">1</span>, <span class="at">e2 =</span> <span class="dv">1</span>, <span class="at">d =</span> <span class="fl">0.01</span>, <span class="at">S0 =</span> <span class="fl">0.1</span>)  <span class="co"># R and S0 should be the same in the chemostat</span></span>
<span id="cb43-15"><a href="week-12.html#cb43-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-16"><a href="week-12.html#cb43-16" aria-hidden="true" tabindex="-1"></a><span class="do">### Model application</span></span>
<span id="cb43-17"><a href="week-12.html#cb43-17" aria-hidden="true" tabindex="-1"></a>pop_size <span class="ot">&lt;-</span> <span class="fu">ode</span>(<span class="at">func =</span> CR_model_2C_1R, <span class="at">times =</span> times, <span class="at">y =</span> state, <span class="at">parms =</span> parms)</span>
<span id="cb43-18"><a href="week-12.html#cb43-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-19"><a href="week-12.html#cb43-19" aria-hidden="true" tabindex="-1"></a><span class="do">### Visualize the population dynamics</span></span>
<span id="cb43-20"><a href="week-12.html#cb43-20" aria-hidden="true" tabindex="-1"></a>pop_size <span class="sc">%&gt;%</span></span>
<span id="cb43-21"><a href="week-12.html#cb43-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb43-22"><a href="week-12.html#cb43-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>time, <span class="at">names_to =</span> <span class="st">&quot;species&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;N&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-23"><a href="week-12.html#cb43-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trophic =</span> <span class="fu">case_when</span>(species <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;N1&quot;</span>, <span class="st">&quot;N2&quot;</span>) <span class="sc">~</span> <span class="st">&quot;Consumer&quot;</span>,</span>
<span id="cb43-24"><a href="week-12.html#cb43-24" aria-hidden="true" tabindex="-1"></a>                             <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;Resource&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb43-25"><a href="week-12.html#cb43-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> N, <span class="at">color =</span> species)) <span class="sc">+</span> </span>
<span id="cb43-26"><a href="week-12.html#cb43-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb43-27"><a href="week-12.html#cb43-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> trophic, </span>
<span id="cb43-28"><a href="week-12.html#cb43-28" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol =</span> <span class="dv">2</span>, </span>
<span id="cb43-29"><a href="week-12.html#cb43-29" aria-hidden="true" tabindex="-1"></a>             <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>,</span>
<span id="cb43-30"><a href="week-12.html#cb43-30" aria-hidden="true" tabindex="-1"></a>             <span class="at">strip.position =</span> <span class="st">&quot;left&quot;</span>) <span class="sc">+</span></span>
<span id="cb43-31"><a href="week-12.html#cb43-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb43-32"><a href="week-12.html#cb43-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb43-33"><a href="week-12.html#cb43-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement =</span> <span class="st">&quot;outside&quot;</span>,</span>
<span id="cb43-34"><a href="week-12.html#cb43-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>,</span>
<span id="cb43-35"><a href="week-12.html#cb43-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb43-36"><a href="week-12.html#cb43-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">r =</span> <span class="dv">5</span>)) <span class="sc">+</span> </span>
<span id="cb43-37"><a href="week-12.html#cb43-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Time&quot;</span>, <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb43-38"><a href="week-12.html#cb43-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1050</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb43-39"><a href="week-12.html#cb43-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb43-40"><a href="week-12.html#cb43-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="cn">NULL</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#377EB8&quot;</span>, <span class="st">&quot;#E41A1C&quot;</span>, <span class="st">&quot;#4DAF4A&quot;</span>))</span></code></pre></div>
<img src="12_Week_12_files/figure-html/unnamed-chunk-2-1.png" width="90%" style="display: block; margin: auto;" />
<div style="height:15px ;">
<br>
</div>
<p>We can see that <em>N<sub>1</sub></em> goes extinct, as predicted by the R* rule; the remaining consumer <em>N<sub>2</sub></em> and the resource <em>R</em> exhibit stable coexistence.</p>
<p><br></p>
</div>
<div id="part-2---tilmans-resource-ratio-hypothesis" class="section level3 unnumbered">
<h3>Part 2 - Tilman’s resource ratio hypothesis</h3>
<p>Now we will extend the model in Part 1. into two consumers and two resources:</p>
<div style="margin-left: 15%;">
<span class="math inline">\(\begin{align}\frac {dN_{1}}{dt} = e_{1}a_{1a}R_{a}N_{1}+e_{1}a_{1b}R_{b}N_{1}-dN_{1}\end{align}\\\)</span>
</div>
<div style="margin-left: 15%;">
<span class="math inline">\(\begin{align}\frac {dN_{2}}{dt} = e_{2}a_{2a}R_{a}N_{2}+e_{2}a_{2b}R_{b}N_{2}-dN_{2}\end{align}\\\)</span>
</div>
<div style="margin-left: 15%; margin-bottom: 15px;">
<span class="math inline">\(\begin{align}\frac {dR_{a}}{dt} = d(S_{a}-R_{a})-a_{1a}R_{a}N_{1}-a_{2a}R_{a}N_{2}\end{align}\)</span>
</div>
<div style="margin-left: 15%; margin-bottom: 15px;">
<span class="math inline">\(\begin{align}\frac {dR_{b}}{dt} = d(S_{b}-R_{b})-a_{1b}R_{b}N_{1}-a_{2b}R_{b}N_{2}\end{align}\)</span>
</div>
<p>Here, the two consumers <em>N<sub>1</sub></em> and <em>N<sub>2</sub></em> compete for two substitutable resources <em>R<sub>1</sub></em> and <em>R<sub>2</sub></em>. Under certain conditions, the two consumers are able to coexist:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="week-12.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb44-2"><a href="week-12.html#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(deSolve)</span>
<span id="cb44-3"><a href="week-12.html#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="week-12.html#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="do">### Model specification</span></span>
<span id="cb44-5"><a href="week-12.html#cb44-5" aria-hidden="true" tabindex="-1"></a>CR_model_2C_2R <span class="ot">&lt;-</span> <span class="cf">function</span>(time, state, parms){</span>
<span id="cb44-6"><a href="week-12.html#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">as.list</span>(<span class="fu">c</span>(state, parms)), {</span>
<span id="cb44-7"><a href="week-12.html#cb44-7" aria-hidden="true" tabindex="-1"></a>    dN1_dt <span class="ot">=</span> e1<span class="sc">*</span>a1a<span class="sc">*</span>Ra<span class="sc">*</span>N1 <span class="sc">+</span> e1<span class="sc">*</span>a1b<span class="sc">*</span>Rb<span class="sc">*</span>N1 <span class="sc">-</span> d<span class="sc">*</span>N1</span>
<span id="cb44-8"><a href="week-12.html#cb44-8" aria-hidden="true" tabindex="-1"></a>    dN2_dt <span class="ot">=</span> e2<span class="sc">*</span>a2a<span class="sc">*</span>Ra<span class="sc">*</span>N2 <span class="sc">+</span> e2<span class="sc">*</span>a2b<span class="sc">*</span>Rb<span class="sc">*</span>N2 <span class="sc">-</span> d<span class="sc">*</span>N2</span>
<span id="cb44-9"><a href="week-12.html#cb44-9" aria-hidden="true" tabindex="-1"></a>    dRa_dt <span class="ot">=</span> d<span class="sc">*</span>(Sa<span class="sc">-</span>Ra) <span class="sc">-</span> (a1a<span class="sc">*</span>N1<span class="sc">*</span>Ra) <span class="sc">-</span> (a2a<span class="sc">*</span>N2<span class="sc">*</span>Ra) </span>
<span id="cb44-10"><a href="week-12.html#cb44-10" aria-hidden="true" tabindex="-1"></a>    dRb_dt <span class="ot">=</span> d<span class="sc">*</span>(Sb<span class="sc">-</span>Rb) <span class="sc">-</span> (a1b<span class="sc">*</span>N1<span class="sc">*</span>Rb) <span class="sc">-</span> (a2b<span class="sc">*</span>N2<span class="sc">*</span>Rb)</span>
<span id="cb44-11"><a href="week-12.html#cb44-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="fu">c</span>(dN1_dt, dN2_dt, dRa_dt, dRb_dt)))</span>
<span id="cb44-12"><a href="week-12.html#cb44-12" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb44-13"><a href="week-12.html#cb44-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-14"><a href="week-12.html#cb44-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-15"><a href="week-12.html#cb44-15" aria-hidden="true" tabindex="-1"></a><span class="do">### Model parameters</span></span>
<span id="cb44-16"><a href="week-12.html#cb44-16" aria-hidden="true" tabindex="-1"></a>times <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="dv">2000</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb44-17"><a href="week-12.html#cb44-17" aria-hidden="true" tabindex="-1"></a>state <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">N1 =</span> <span class="fl">0.05</span>, <span class="at">N2 =</span> <span class="fl">0.05</span>, <span class="at">Ra =</span> <span class="fl">0.3</span>, <span class="at">Rb =</span> <span class="fl">0.3</span>)</span>
<span id="cb44-18"><a href="week-12.html#cb44-18" aria-hidden="true" tabindex="-1"></a>parms <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">a1a =</span> <span class="fl">0.4</span>, <span class="at">a1b =</span> <span class="fl">0.8</span>, <span class="at">a2a =</span> <span class="fl">0.6</span>, <span class="at">a2b =</span> <span class="fl">0.5</span>, <span class="at">e1 =</span> <span class="dv">1</span>, <span class="at">e2 =</span> <span class="dv">1</span>, <span class="at">d =</span> <span class="fl">0.1</span>, <span class="at">Sa =</span> <span class="fl">0.3</span>, <span class="at">Sb =</span> <span class="fl">0.3</span>)  <span class="co"># Ra/Rb and S0a/S0b should be the same in the chemostat</span></span>
<span id="cb44-19"><a href="week-12.html#cb44-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-20"><a href="week-12.html#cb44-20" aria-hidden="true" tabindex="-1"></a><span class="do">### Model application</span></span>
<span id="cb44-21"><a href="week-12.html#cb44-21" aria-hidden="true" tabindex="-1"></a>pop_size <span class="ot">&lt;-</span> <span class="fu">ode</span>(<span class="at">func =</span> CR_model_2C_2R, <span class="at">times =</span> times, <span class="at">y =</span> state, <span class="at">parms =</span> parms)</span>
<span id="cb44-22"><a href="week-12.html#cb44-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-23"><a href="week-12.html#cb44-23" aria-hidden="true" tabindex="-1"></a><span class="do">### Visualize the population dynamics</span></span>
<span id="cb44-24"><a href="week-12.html#cb44-24" aria-hidden="true" tabindex="-1"></a>pop_size <span class="sc">%&gt;%</span></span>
<span id="cb44-25"><a href="week-12.html#cb44-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-26"><a href="week-12.html#cb44-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>time, <span class="at">names_to =</span> <span class="st">&quot;species&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;N&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-27"><a href="week-12.html#cb44-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trophic =</span> <span class="fu">case_when</span>(species <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;N1&quot;</span>, <span class="st">&quot;N2&quot;</span>) <span class="sc">~</span> <span class="st">&quot;Consumer&quot;</span>,</span>
<span id="cb44-28"><a href="week-12.html#cb44-28" aria-hidden="true" tabindex="-1"></a>                             <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;Resource&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb44-29"><a href="week-12.html#cb44-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> N, <span class="at">color =</span> species)) <span class="sc">+</span> </span>
<span id="cb44-30"><a href="week-12.html#cb44-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb44-31"><a href="week-12.html#cb44-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> trophic, </span>
<span id="cb44-32"><a href="week-12.html#cb44-32" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol =</span> <span class="dv">2</span>, </span>
<span id="cb44-33"><a href="week-12.html#cb44-33" aria-hidden="true" tabindex="-1"></a>             <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>,</span>
<span id="cb44-34"><a href="week-12.html#cb44-34" aria-hidden="true" tabindex="-1"></a>             <span class="at">strip.position =</span> <span class="st">&quot;left&quot;</span>) <span class="sc">+</span></span>
<span id="cb44-35"><a href="week-12.html#cb44-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb44-36"><a href="week-12.html#cb44-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb44-37"><a href="week-12.html#cb44-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement =</span> <span class="st">&quot;outside&quot;</span>,</span>
<span id="cb44-38"><a href="week-12.html#cb44-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>,</span>
<span id="cb44-39"><a href="week-12.html#cb44-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb44-40"><a href="week-12.html#cb44-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">r =</span> <span class="dv">8</span>)) <span class="sc">+</span> </span>
<span id="cb44-41"><a href="week-12.html#cb44-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Time&quot;</span>, <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb44-42"><a href="week-12.html#cb44-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2050</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb44-43"><a href="week-12.html#cb44-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb44-44"><a href="week-12.html#cb44-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="cn">NULL</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#377EB8&quot;</span>, <span class="st">&quot;#E41A1C&quot;</span>, <span class="st">&quot;#4DAF4A&quot;</span>, <span class="st">&quot;#984EA3&quot;</span>))</span></code></pre></div>
<p><img src="12_Week_12_files/figure-html/unnamed-chunk-3-1.png" width="90%" style="display: block; margin: auto;" />
<br></p>
<p>The phase diagram also illustrates stable coexistence of the two consumers:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="week-12.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Parameters</span></span>
<span id="cb45-2"><a href="week-12.html#cb45-2" aria-hidden="true" tabindex="-1"></a>a1a <span class="ot">&lt;-</span> <span class="fl">0.4</span></span>
<span id="cb45-3"><a href="week-12.html#cb45-3" aria-hidden="true" tabindex="-1"></a>a1b <span class="ot">&lt;-</span> <span class="fl">0.8</span></span>
<span id="cb45-4"><a href="week-12.html#cb45-4" aria-hidden="true" tabindex="-1"></a>a2a <span class="ot">&lt;-</span> <span class="fl">0.6</span></span>
<span id="cb45-5"><a href="week-12.html#cb45-5" aria-hidden="true" tabindex="-1"></a>a2b <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb45-6"><a href="week-12.html#cb45-6" aria-hidden="true" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb45-7"><a href="week-12.html#cb45-7" aria-hidden="true" tabindex="-1"></a>e2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb45-8"><a href="week-12.html#cb45-8" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb45-9"><a href="week-12.html#cb45-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-10"><a href="week-12.html#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="do">### Slopes and intercepts of the ZNGI&#39;s</span></span>
<span id="cb45-11"><a href="week-12.html#cb45-11" aria-hidden="true" tabindex="-1"></a>ZNGI_slope_N1 <span class="ot">&lt;-</span> <span class="sc">-</span>a1a<span class="sc">/</span>a1b</span>
<span id="cb45-12"><a href="week-12.html#cb45-12" aria-hidden="true" tabindex="-1"></a>ZNGI_intercept_N1 <span class="ot">&lt;-</span> d<span class="sc">/</span>(e1<span class="sc">*</span>a1b)  </span>
<span id="cb45-13"><a href="week-12.html#cb45-13" aria-hidden="true" tabindex="-1"></a>ZNGI_slope_N2 <span class="ot">&lt;-</span> <span class="sc">-</span>a2a<span class="sc">/</span>a2b</span>
<span id="cb45-14"><a href="week-12.html#cb45-14" aria-hidden="true" tabindex="-1"></a>ZNGI_intercept_N2 <span class="ot">&lt;-</span> d<span class="sc">/</span>(e2<span class="sc">*</span>a2b)</span>
<span id="cb45-15"><a href="week-12.html#cb45-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-16"><a href="week-12.html#cb45-16" aria-hidden="true" tabindex="-1"></a><span class="do">### Consumption vectors</span></span>
<span id="cb45-17"><a href="week-12.html#cb45-17" aria-hidden="true" tabindex="-1"></a>eqilibrium_Ra <span class="ot">&lt;-</span> (d<span class="sc">/</span>e1)<span class="sc">*</span>((a1b<span class="sc">-</span>a2b)<span class="sc">/</span>(a2a<span class="sc">*</span>a1b<span class="sc">-</span>a2b<span class="sc">*</span>a1a))</span>
<span id="cb45-18"><a href="week-12.html#cb45-18" aria-hidden="true" tabindex="-1"></a>eqilibrium_Rb <span class="ot">&lt;-</span> (d<span class="sc">/</span>e2)<span class="sc">*</span>((a1a<span class="sc">-</span>a2a)<span class="sc">/</span>(a2b<span class="sc">*</span>a1a<span class="sc">-</span>a2a<span class="sc">*</span>a1b))</span>
<span id="cb45-19"><a href="week-12.html#cb45-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-20"><a href="week-12.html#cb45-20" aria-hidden="true" tabindex="-1"></a>convec_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(eqilibrium_Ra <span class="sc">+</span> <span class="dv">6</span><span class="sc">*</span>a1a<span class="sc">*</span>eqilibrium_Ra, </span>
<span id="cb45-21"><a href="week-12.html#cb45-21" aria-hidden="true" tabindex="-1"></a>                              eqilibrium_Ra <span class="sc">+</span> <span class="dv">6</span><span class="sc">*</span>a2a<span class="sc">*</span>eqilibrium_Ra),</span>
<span id="cb45-22"><a href="week-12.html#cb45-22" aria-hidden="true" tabindex="-1"></a>                        <span class="at">y =</span> <span class="fu">c</span>(eqilibrium_Rb <span class="sc">+</span> <span class="dv">6</span><span class="sc">*</span>a1b<span class="sc">*</span>eqilibrium_Rb, </span>
<span id="cb45-23"><a href="week-12.html#cb45-23" aria-hidden="true" tabindex="-1"></a>                              eqilibrium_Rb <span class="sc">+</span> <span class="dv">6</span><span class="sc">*</span>a2b<span class="sc">*</span>eqilibrium_Rb),</span>
<span id="cb45-24"><a href="week-12.html#cb45-24" aria-hidden="true" tabindex="-1"></a>                        <span class="at">xend =</span> <span class="fu">c</span>(eqilibrium_Ra <span class="sc">-</span> a1a<span class="sc">*</span>eqilibrium_Ra, </span>
<span id="cb45-25"><a href="week-12.html#cb45-25" aria-hidden="true" tabindex="-1"></a>                              eqilibrium_Ra <span class="sc">-</span> a2a<span class="sc">*</span>eqilibrium_Ra),</span>
<span id="cb45-26"><a href="week-12.html#cb45-26" aria-hidden="true" tabindex="-1"></a>                        <span class="at">yend =</span> <span class="fu">c</span>(eqilibrium_Rb <span class="sc">-</span> a1b<span class="sc">*</span>eqilibrium_Rb, </span>
<span id="cb45-27"><a href="week-12.html#cb45-27" aria-hidden="true" tabindex="-1"></a>                              eqilibrium_Rb <span class="sc">-</span> a2b<span class="sc">*</span>eqilibrium_Rb),</span>
<span id="cb45-28"><a href="week-12.html#cb45-28" aria-hidden="true" tabindex="-1"></a>                        <span class="at">species =</span> <span class="fu">c</span>(<span class="st">&quot;N1&quot;</span>, <span class="st">&quot;N2&quot;</span>))</span>
<span id="cb45-29"><a href="week-12.html#cb45-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-30"><a href="week-12.html#cb45-30" aria-hidden="true" tabindex="-1"></a><span class="do">### Phase diagram</span></span>
<span id="cb45-31"><a href="week-12.html#cb45-31" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb45-32"><a href="week-12.html#cb45-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> ZNGI_slope_N1, <span class="at">intercept =</span> ZNGI_intercept_N1, <span class="at">color =</span> <span class="st">&quot;#377EB8&quot;</span>, <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span> </span>
<span id="cb45-33"><a href="week-12.html#cb45-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> ZNGI_slope_N2, <span class="at">intercept =</span> ZNGI_intercept_N2, <span class="at">color =</span> <span class="st">&quot;#E41A1C&quot;</span>, <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span> </span>
<span id="cb45-34"><a href="week-12.html#cb45-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> convec_df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">xend =</span> xend, <span class="at">yend =</span> yend, <span class="at">color =</span> species), <span class="at">linetype =</span> <span class="st">&quot;blank&quot;</span>) <span class="sc">+</span> </span>
<span id="cb45-35"><a href="week-12.html#cb45-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> convec_df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">xend =</span> xend, <span class="at">yend =</span> yend, <span class="at">color =</span> species), <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">type =</span> <span class="st">&quot;closed&quot;</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">&quot;inches&quot;</span>)), <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb45-36"><a href="week-12.html#cb45-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">data =</span> <span class="fu">as.data.frame</span>(pop_size), <span class="fu">aes</span>(<span class="at">x =</span> Ra, <span class="at">y =</span> Rb)) <span class="sc">+</span></span>
<span id="cb45-37"><a href="week-12.html#cb45-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">as.data.frame</span>(pop_size), <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">last</span>(Ra), <span class="at">y =</span> <span class="fu">last</span>(Rb)), <span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb45-38"><a href="week-12.html#cb45-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb45-39"><a href="week-12.html#cb45-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(<span class="fu">italic</span>(R[a])), <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">italic</span>(R[b]))) <span class="sc">+</span></span>
<span id="cb45-40"><a href="week-12.html#cb45-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb45-41"><a href="week-12.html#cb45-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb45-42"><a href="week-12.html#cb45-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">name =</span> <span class="cn">NULL</span>, <span class="at">palette =</span> <span class="st">&quot;Set1&quot;</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb45-43"><a href="week-12.html#cb45-43" aria-hidden="true" tabindex="-1"></a>                     <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(</span>
<span id="cb45-44"><a href="week-12.html#cb45-44" aria-hidden="true" tabindex="-1"></a>                       <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">size =</span> <span class="fl">1.2</span>))) <span class="sc">+</span></span>
<span id="cb45-45"><a href="week-12.html#cb45-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="12_Week_12_files/figure-html/unnamed-chunk-4-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>In this particular case, if the initial resource levels <em>R<sub>a0</sub></em> and <em>R<sub>b0</sub></em> fall within the upper area bounded by the two consumption vectors, then the two species will coexist.</p>
<p><br></p>
</div>
<div id="part-3---relative-nonlinearity" class="section level3 unnumbered">
<h3>Part 3 - Relative nonlinearity</h3>
<p>We have seen in Part 1. that two species cannot coexist on one resource if the consumers consume it in a linear fashion. What if the consumers consume the resource in a non-linear fashion? Could that generate stable coexistence?</p>
<p>In this part of the lab section, we will introduce non-linear (type II) functional response into the consumer-resource model in Part 1. for one of the consumers. We also change the resource equation to logistic growth and allow the two consumers to have different conversion efficiencies and mortality rates:</p>
<div style="margin-left: 25%;">
<span class="math inline">\(\begin{align}\frac {dN_{1}}{dt} = e_{1}a_{1}RN_{1}-d_{1}N_{1}\end{align}\\\)</span>
</div>
<div style="margin-left: 25%;">
<span class="math inline">\(\begin{align}\frac {dN_{2}}{dt} = e_{2}\frac{a_{2}R}{k_{2}+R}N_{2}-d_{2}N_{2}\end{align}\\\)</span>
</div>
<div style="margin-left: 25%; margin-bottom: 15px;">
<span class="math inline">\(\begin{align}\frac {dR}{dt} = rR(1-\frac{R}{K})-a_{1}RN_{1}-\frac{a_{2}R}{k_{2}+R}N_{2}\end{align}\)</span>
</div>
<div style="height:15px ;">
<br>
</div>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="week-12.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb46-2"><a href="week-12.html#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(deSolve)</span>
<span id="cb46-3"><a href="week-12.html#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="week-12.html#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="do">### Model specification</span></span>
<span id="cb46-5"><a href="week-12.html#cb46-5" aria-hidden="true" tabindex="-1"></a>CR_model_nonlinear <span class="ot">&lt;-</span> <span class="cf">function</span>(times, state, parms){</span>
<span id="cb46-6"><a href="week-12.html#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">as.list</span>(<span class="fu">c</span>(state, parms)), {</span>
<span id="cb46-7"><a href="week-12.html#cb46-7" aria-hidden="true" tabindex="-1"></a>         dN1_dt <span class="ot">=</span> e1<span class="sc">*</span>a1<span class="sc">*</span>R<span class="sc">*</span>N1 <span class="sc">-</span> d1<span class="sc">*</span>N1</span>
<span id="cb46-8"><a href="week-12.html#cb46-8" aria-hidden="true" tabindex="-1"></a>         dN2_dt <span class="ot">=</span> e2<span class="sc">*</span>(a2<span class="sc">*</span>R<span class="sc">/</span>(k2<span class="sc">+</span>R))<span class="sc">*</span>N2 <span class="sc">-</span> d2<span class="sc">*</span>N2</span>
<span id="cb46-9"><a href="week-12.html#cb46-9" aria-hidden="true" tabindex="-1"></a>         dR_dt <span class="ot">=</span>  r<span class="sc">*</span>R<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>(R<span class="sc">/</span>K)) <span class="sc">-</span> a1<span class="sc">*</span>R<span class="sc">*</span>N1 <span class="sc">-</span> ((a2<span class="sc">*</span>R)<span class="sc">/</span>(k2<span class="sc">+</span>R))<span class="sc">*</span>N2</span>
<span id="cb46-10"><a href="week-12.html#cb46-10" aria-hidden="true" tabindex="-1"></a>         <span class="fu">return</span>(<span class="fu">list</span>(<span class="fu">c</span>(dN1_dt, dN2_dt, dR_dt)))</span>
<span id="cb46-11"><a href="week-12.html#cb46-11" aria-hidden="true" tabindex="-1"></a>       })</span>
<span id="cb46-12"><a href="week-12.html#cb46-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-13"><a href="week-12.html#cb46-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-14"><a href="week-12.html#cb46-14" aria-hidden="true" tabindex="-1"></a><span class="do">### Model parameters</span></span>
<span id="cb46-15"><a href="week-12.html#cb46-15" aria-hidden="true" tabindex="-1"></a>times <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">5000</span>, <span class="at">by =</span> <span class="fl">0.1</span>)  </span>
<span id="cb46-16"><a href="week-12.html#cb46-16" aria-hidden="true" tabindex="-1"></a>state <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">N1 =</span> <span class="fl">0.3</span>, <span class="at">N2 =</span> <span class="dv">19</span>, <span class="at">R =</span> <span class="dv">106</span>) </span>
<span id="cb46-17"><a href="week-12.html#cb46-17" aria-hidden="true" tabindex="-1"></a>parms <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">a1 =</span> <span class="fl">0.003</span>, <span class="at">a2 =</span> <span class="fl">0.5</span>, <span class="at">k2 =</span> <span class="dv">50</span>, <span class="at">e1 =</span> <span class="fl">0.33</span>, <span class="at">e2 =</span> <span class="fl">0.3</span>, <span class="at">d1 =</span> <span class="fl">0.11</span>, <span class="at">d2 =</span> <span class="fl">0.1</span>, <span class="at">r =</span> <span class="fl">0.1</span>, <span class="at">K =</span> <span class="dv">300</span>)</span>
<span id="cb46-18"><a href="week-12.html#cb46-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-19"><a href="week-12.html#cb46-19" aria-hidden="true" tabindex="-1"></a><span class="do">### Model application</span></span>
<span id="cb46-20"><a href="week-12.html#cb46-20" aria-hidden="true" tabindex="-1"></a>pop_size <span class="ot">&lt;-</span> <span class="fu">ode</span>(<span class="at">func =</span> CR_model_nonlinear, <span class="at">times =</span> times, <span class="at">y =</span> state, <span class="at">parms =</span> parms)</span>
<span id="cb46-21"><a href="week-12.html#cb46-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-22"><a href="week-12.html#cb46-22" aria-hidden="true" tabindex="-1"></a>pop_size <span class="sc">%&gt;%</span></span>
<span id="cb46-23"><a href="week-12.html#cb46-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb46-24"><a href="week-12.html#cb46-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>time, <span class="at">names_to =</span> <span class="st">&quot;species&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;N&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-25"><a href="week-12.html#cb46-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trophic =</span> <span class="fu">case_when</span>(species <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;N1&quot;</span>, <span class="st">&quot;N2&quot;</span>) <span class="sc">~</span> <span class="st">&quot;Consumer&quot;</span>,</span>
<span id="cb46-26"><a href="week-12.html#cb46-26" aria-hidden="true" tabindex="-1"></a>                             <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;Resource&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb46-27"><a href="week-12.html#cb46-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> N, <span class="at">color =</span> species)) <span class="sc">+</span> </span>
<span id="cb46-28"><a href="week-12.html#cb46-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb46-29"><a href="week-12.html#cb46-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> trophic, </span>
<span id="cb46-30"><a href="week-12.html#cb46-30" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol =</span> <span class="dv">2</span>, </span>
<span id="cb46-31"><a href="week-12.html#cb46-31" aria-hidden="true" tabindex="-1"></a>             <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>,</span>
<span id="cb46-32"><a href="week-12.html#cb46-32" aria-hidden="true" tabindex="-1"></a>             <span class="at">strip.position =</span> <span class="st">&quot;left&quot;</span>) <span class="sc">+</span></span>
<span id="cb46-33"><a href="week-12.html#cb46-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb46-34"><a href="week-12.html#cb46-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb46-35"><a href="week-12.html#cb46-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement =</span> <span class="st">&quot;outside&quot;</span>,</span>
<span id="cb46-36"><a href="week-12.html#cb46-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>,</span>
<span id="cb46-37"><a href="week-12.html#cb46-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb46-38"><a href="week-12.html#cb46-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">r =</span> <span class="dv">5</span>)) <span class="sc">+</span> </span>
<span id="cb46-39"><a href="week-12.html#cb46-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Time&quot;</span>, <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb46-40"><a href="week-12.html#cb46-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5050</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb46-41"><a href="week-12.html#cb46-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb46-42"><a href="week-12.html#cb46-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="cn">NULL</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#377EB8&quot;</span>, <span class="st">&quot;#E41A1C&quot;</span>, <span class="st">&quot;#4DAF4A&quot;</span>))</span></code></pre></div>
<img src="12_Week_12_files/figure-html/unnamed-chunk-5-1.png" width="90%" style="display: block; margin: auto;" />
<div style="height:15px ;">
<br>
</div>
<p>As shown in the figure, the two consumers coexist in a fluctuating manner. In fact, the fluctuating properties generated by the combination of logistically growing resources and different nonlinear functions are critical for the coexistence of <em>n</em> species on <em>k</em> &lt; <em>n</em> resources in certain parameter spaces.</p>
<p><br></p>
</div>
</div>
<div id="additional-readings-10" class="section level2 unnumbered">
<h2>Additional readings</h2>
<p><a href="./Additional%20readings/Armstrong_&amp;_McGehee_1980_AmNat.pdf" target="_blank">Competitive Exclusion</a></p>
<p><a href="./Additional%20readings/Tilman_1980_AmNat.pdf" target="_blank">A Graphical-Mechanistic Approach to Competition and Predation</a></p>
<p><a href="./Additional%20readings/Vincent_et_al_1996_AmNat.pdf" target="_blank">Trade-Offs and Coexistence in Consumer-Resource Models: It all Depends on what and where you Eat</a></p>
<p><br></p>
</div>
<div id="assignments-10" class="section level2 unnumbered">
<h2>Assignments</h2>
<p><a href="./Assignments/Week12_Apparent%20Competition.pdf" target="_blank">Apparent Competition and P* Rule</a></p>
<p><a href="./Assignments/Week12_Apparent%20Competition_with_Solutions.pdf" target="_blank">Suggested Solutions</a></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="week-11.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="week-13.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"info": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
