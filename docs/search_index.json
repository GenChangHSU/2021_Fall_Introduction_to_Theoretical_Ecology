[["week-7.html", "Week 7 Lecture in a nutshell Lab demonstration Additional readings Assignments", " Week 7 Lotka-Volterra model of competition: graphical analysis Lecture in a nutshell Topic: Topic: Lab demonstration In this lab, we are going to analyze the two-species Lotka-Volterra competition model and visualize the population dynamics under different parameter settings. library(tidyverse) library(deSolve) LV_pop_dynamics &lt;- function(r1 = 1.4, r2 = 1.2, a11 = 1/200, a21 = 1/400, a22 = 1/200, a12 = 1/300) { ### Model specification LV_competition_model &lt;- function(times, state, parms) { with(as.list(c(state, parms)), { dN1_dt = N1*(r1-a11*N1-a12*N2) dN2_dt = N2*(r2-a22*N2-a21*N1) return(list(c(dN1_dt, dN2_dt))) }) } ### Model parameters times &lt;- seq(0, 100, by = 0.1) state &lt;- c(N1 = 10, N2 = 10) parms &lt;- c(r1 = r1, r2 = r2, a11 = a11, a21 = a21, a22 = a22, a12 = a12) ### Model application pop_size &lt;- ode(func = LV_competition_model, times = times, y = state, parms = parms) ### Visualize the population dynamics pop_size %&gt;% as.data.frame() %&gt;% pivot_longer(cols = -time, names_to = &quot;species&quot;, values_to = &quot;N&quot;) %&gt;% ggplot(aes(x = time, y = N, color = species)) + geom_line(size = 1.5) + theme_classic(base_size = 12) + labs(x = &quot;Time&quot;, y = &quot;Population size&quot;) + scale_x_continuous(limits = c(0, 100.5), expand = c(0, 0)) + scale_y_continuous(limits = c(0, max(pop_size)*1.2), expand = c(0, 0)) + scale_color_brewer(name = NULL, palette = &quot;Set1&quot;) } ### Different parameter settings LV_pop_dynamics(r1 = 1.4, r2 = 1.2, a11 = 1/200, a21 = 1/400, a22 = 1/200, a12 = 1/300) # stable coexistence LV_pop_dynamics(r1 = 1.2, r2 = 1.2, a11 = 1/200, a21 = 1/100, a22 = 1/100, a12 = 1/300) # N1 wins LV_pop_dynamics(r1 = 1.2, r2 = 1.2, a11 = 1/200, a21 = 1/500, a22 = 1/500, a12 = 1/300) # N2 wins Here is the phase plane of the system in which the two species exhibit stable coexistence: ### Parameters r1 &lt;- 1.4 r2 &lt;- 1.2 a11 &lt;- 1/200 a21 &lt;- 1/400 a22 &lt;- 1/200 a12 &lt;- 1/300 ### Vectors LV_competition_model &lt;- function(times, state, parms) { with(as.list(c(state, parms)), { dN1_dt = N1*(r1-a11*N1-a12*N2) dN2_dt = N2*(r2-a22*N2-a21*N1) return(list(c(dN1_dt, dN2_dt))) }) } times &lt;- seq(0, 0.1, by = 0.1) parms &lt;- c(r1 = r1, r2 = r2, a11 = a11, a21 = a21, a22 = a22, a12 = a12) vector_grid &lt;- expand.grid(seq(5, 505, 20), seq(5, 505, 20)) vector_data &lt;- vector_grid %&gt;% pmap(., function(Var1, Var2){ state &lt;- c(N1 = Var1, N2 = Var2) pop_size &lt;- ode(func = LV_competition_model, times = times, y = state, parms = parms) pop_size[2, 2:3] }) %&gt;% bind_rows() %&gt;% rename(xend = N1, yend = N2) %&gt;% bind_cols(vector_grid) %&gt;% rename(x = Var1, y = Var2) ### Phase plane ggplot() + geom_abline(slope = -a11/a12, intercept = r1/a12, color = &quot;#E41A1C&quot;, size = 1.5) + geom_abline(slope = -a21/a22, intercept = r2/a22, color = &quot;#377EB8&quot;, size = 1.5) + geom_segment(data = vector_data, aes(x = x, y = y, xend = xend, yend = yend), arrow = arrow(length = unit(0.1, &quot;cm&quot;))) + geom_point(aes(x = (a22*r1-a12*r2)/(a11*a22-a12*a21), y = (a21*r1-a11*r2)/(a12*a21-a11*a22)), color = &quot;red&quot;, size = 4) + scale_x_continuous(name = &quot;N1&quot;, limits = c(0, 505), expand = c(0, 0)) + scale_y_continuous(name = &quot;N2&quot;, limits = c(0, 505), expand = c(0, 0)) + theme_bw(base_size = 13) + theme(panel.grid = element_blank()) Additional readings Assignments Graphical Analysis of Lotka-Volterra Competition Model "]]
